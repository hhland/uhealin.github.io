<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tunnel SDK 示例 &mdash; ODPS 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ODPS 1.0 documentation" href="../../index.html" />
    <link rel="up" title="ODPS TUNNEL" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../odps_sdk/sdk.html" title="ODPS SDK介绍"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="odps_tunnel_summary.html" title="Tunnel SDK简介"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">ODPS 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">ODPS TUNNEL</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tunnel-sdk">
<h1>Tunnel SDK 示例<a class="headerlink" href="#tunnel-sdk" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">在下面的示例中，请用户注意区分ODPS及其Tunnel服务的endpoint的设置区别。详细介绍在 <a class="reference internal" href="odps_tunnel_summary.html#odps-tunnel-sdk"><em>Tunnel SDK简介</em></a> 开篇中有介绍。</p>
</div>
<div class="section" id="id1">
<h2>简单上传示例<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</pre></div></td><td class="code"><div class="highlight"><pre> <span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Column</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Odps</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.PartitionSpec</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.TableSchema</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.Account</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.AliyunAccount</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.Record</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.RecordWriter</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.DataTunnel</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.TunnelException</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.UploadSession</span><span class="o">;</span>

 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UploadSample</span> <span class="o">{</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessId</span> <span class="o">=</span> <span class="s">&quot;&lt;your access id&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessKey</span> <span class="o">=</span> <span class="s">&quot;&lt;your access Key&gt;&quot;</span><span class="o">;</span>
         <span class="cm">/*</span>
<span class="cm">          * Tunnel服务内网地址：http://dt-ext.odps.aliyun-inc.com</span>
<span class="cm">          * Tunnel服务公网地址：http://dt.odps.aliyun.com</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">tunnelUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your tunnel endpoint&gt;&quot;</span><span class="o">;</span>

         <span class="cm">/*</span>
<span class="cm">          * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm">          * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>

         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">project</span> <span class="o">=</span> <span class="s">&quot;&lt;your project&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">table</span> <span class="o">=</span> <span class="s">&quot;&lt;your table name&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">partition</span> <span class="o">=</span> <span class="s">&quot;&lt;your partition spec&gt;&quot;</span><span class="o">;</span>

         <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
                 <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="n">accessId</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">);</span>
                 <span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="n">project</span><span class="o">);</span>
                 <span class="k">try</span> <span class="o">{</span>
                         <span class="n">DataTunnel</span> <span class="n">tunnel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataTunnel</span><span class="o">(</span><span class="n">odps</span><span class="o">);</span>
                         <span class="n">tunnel</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">tunnelUrl</span><span class="o">);</span>
                         <span class="n">PartitionSpec</span> <span class="n">partitionSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PartitionSpec</span><span class="o">(</span><span class="n">partition</span><span class="o">);</span>
                         <span class="n">UploadSession</span> <span class="n">uploadSession</span> <span class="o">=</span> <span class="n">tunnel</span><span class="o">.</span><span class="na">createUploadSession</span><span class="o">(</span><span class="n">project</span><span class="o">,</span>
                                         <span class="n">table</span><span class="o">,</span> <span class="n">partitionSpec</span><span class="o">);</span>

                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Session Status is : &quot;</span>
                                         <span class="o">+</span> <span class="n">uploadSession</span><span class="o">.</span><span class="na">getStatus</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

                         <span class="n">TableSchema</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">uploadSession</span><span class="o">.</span><span class="na">getSchema</span><span class="o">();</span>
                         <span class="n">RecordWriter</span> <span class="n">recordWriter</span> <span class="o">=</span> <span class="n">uploadSession</span><span class="o">.</span><span class="na">openRecordWriter</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
                         <span class="n">Record</span> <span class="n">record</span> <span class="o">=</span> <span class="n">uploadSession</span><span class="o">.</span><span class="na">newRecord</span><span class="o">();</span>
                         <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumns</span><span class="o">().</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                                 <span class="n">Column</span> <span class="n">column</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumn</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="k">switch</span> <span class="o">(</span><span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
                                 <span class="k">case</span> <span class="nl">BIGINT:</span>
                                         <span class="n">record</span><span class="o">.</span><span class="na">setBigint</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="mi">1L</span><span class="o">);</span>
                                         <span class="k">break</span><span class="o">;</span>
                                 <span class="k">case</span> <span class="nl">BOOLEAN:</span>
                                         <span class="n">record</span><span class="o">.</span><span class="na">setBoolean</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                                         <span class="k">break</span><span class="o">;</span>
                                 <span class="k">case</span> <span class="nl">DATETIME:</span>
                                         <span class="n">record</span><span class="o">.</span><span class="na">setDatetime</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
                                         <span class="k">break</span><span class="o">;</span>
                                 <span class="k">case</span> <span class="nl">DOUBLE:</span>
                                         <span class="n">record</span><span class="o">.</span><span class="na">setDouble</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">);</span>
                                         <span class="k">break</span><span class="o">;</span>
                                 <span class="k">case</span> <span class="nl">STRING:</span>
                                         <span class="n">record</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="s">&quot;sample&quot;</span><span class="o">);</span>
                                         <span class="k">break</span><span class="o">;</span>
                                 <span class="k">default</span><span class="o">:</span>
                                         <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">&quot;Unknown column type: &quot;</span>
                                                         <span class="o">+</span> <span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">());</span>
                                 <span class="o">}</span>
                         <span class="o">}</span>
                         <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                                 <span class="n">recordWriter</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">record</span><span class="o">);</span>
                         <span class="o">}</span>
                         <span class="n">recordWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                         <span class="n">uploadSession</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="k">new</span> <span class="n">Long</span><span class="o">[]{</span><span class="mi">0L</span><span class="o">});</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;upload success!&quot;</span><span class="o">);</span>

                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">TunnelException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span>
         <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id2">
<h2>简单下载示例<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108</pre></div></td><td class="code"><div class="highlight"><pre> <span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Column</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Odps</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.PartitionSpec</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.TableSchema</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.Account</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.AliyunAccount</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.Record</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.RecordReader</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.DataTunnel</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.DownloadSession</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.TunnelException</span><span class="o">;</span>

 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">DownloadSample</span> <span class="o">{</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessId</span> <span class="o">=</span> <span class="s">&quot;&lt;your access id&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessKey</span> <span class="o">=</span> <span class="s">&quot;&lt;your access Key&gt;&quot;</span><span class="o">;</span>
         <span class="cm">/*</span>
<span class="cm">          * Tunnel服务内网地址：http://dt-ext.odps.aliyun-inc.com</span>
<span class="cm">          * Tunnel服务公网地址：http://dt.odps.aliyun.com</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">tunnelUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your tunnel endpoint&gt;&quot;</span><span class="o">;</span>

         <span class="cm">/*</span>
<span class="cm">          * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm">          * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>


         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">project</span> <span class="o">=</span> <span class="s">&quot;&lt;your project&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">table</span> <span class="o">=</span> <span class="s">&quot;&lt;your table name&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">partition</span> <span class="o">=</span> <span class="s">&quot;&lt;your partition spec&gt;&quot;</span><span class="o">;</span>

         <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
                 <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="n">accessId</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">);</span>
                 <span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="n">project</span><span class="o">);</span>
                 <span class="n">DataTunnel</span> <span class="n">tunnel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataTunnel</span><span class="o">(</span><span class="n">odps</span><span class="o">);</span>
                 <span class="n">tunnel</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">tunnelUrl</span><span class="o">);</span>
                 <span class="n">PartitionSpec</span> <span class="n">partitionSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PartitionSpec</span><span class="o">(</span><span class="n">partition</span><span class="o">);</span>
                 <span class="k">try</span> <span class="o">{</span>
                         <span class="n">DownloadSession</span> <span class="n">downloadSession</span> <span class="o">=</span> <span class="n">tunnel</span><span class="o">.</span><span class="na">createDownloadSession</span><span class="o">(</span><span class="n">project</span><span class="o">,</span> <span class="n">table</span><span class="o">,</span>
                                         <span class="n">partitionSpec</span><span class="o">);</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Session Status is : &quot;</span>
                                         <span class="o">+</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">getStatus</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

                         <span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">getRecordCount</span><span class="o">();</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;RecordCount is: &quot;</span> <span class="o">+</span> <span class="n">count</span><span class="o">);</span>

                         <span class="n">RecordReader</span> <span class="n">recordReader</span> <span class="o">=</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">openRecordReader</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span>
                                         <span class="n">count</span><span class="o">);</span>
                         <span class="n">Record</span> <span class="n">record</span><span class="o">;</span>
                         <span class="k">while</span> <span class="o">((</span><span class="n">record</span> <span class="o">=</span> <span class="n">recordReader</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                 <span class="n">consumeRecord</span><span class="o">(</span><span class="n">record</span><span class="o">,</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">getSchema</span><span class="o">());</span>
                         <span class="o">}</span>
                         <span class="n">recordReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">TunnelException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e1</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e1</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span>
         <span class="o">}</span>

         <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">consumeRecord</span><span class="o">(</span><span class="n">Record</span> <span class="n">record</span><span class="o">,</span> <span class="n">TableSchema</span> <span class="n">schema</span><span class="o">)</span> <span class="o">{</span>
                 <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumns</span><span class="o">().</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                         <span class="n">Column</span> <span class="n">column</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumn</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                         <span class="n">String</span> <span class="n">colValue</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                         <span class="k">switch</span> <span class="o">(</span><span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
                         <span class="k">case</span> <span class="nl">BIGINT:</span> <span class="o">{</span>
                                 <span class="n">Long</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getBigint</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">BOOLEAN:</span> <span class="o">{</span>
                                 <span class="n">Boolean</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">DATETIME:</span> <span class="o">{</span>
                                 <span class="n">Date</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getDatetime</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">DOUBLE:</span> <span class="o">{</span>
                                 <span class="n">Double</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getDouble</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">STRING:</span> <span class="o">{</span>
                                 <span class="n">String</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">default</span><span class="o">:</span>
                                 <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">&quot;Unknown column type: &quot;</span>
                                                 <span class="o">+</span> <span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">());</span>
                         <span class="o">}</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">colValue</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="s">&quot;null&quot;</span> <span class="o">:</span> <span class="n">colValue</span><span class="o">);</span>
                         <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumns</span><span class="o">().</span><span class="na">size</span><span class="o">())</span>
                                 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;\t&quot;</span><span class="o">);</span>
                 <span class="o">}</span>
                 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
         <span class="o">}</span>

 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id3">
<h2>多线程上传示例<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre></div></td><td class="code"><div class="highlight"><pre> <span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutorService</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>

 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Column</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Odps</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.PartitionSpec</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.TableSchema</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.Account</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.AliyunAccount</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.Record</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.RecordWriter</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.DataTunnel</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.TunnelException</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.UploadSession</span><span class="o">;</span>

 <span class="kd">class</span> <span class="nc">UploadThread</span> <span class="kd">implements</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="o">{</span>
         <span class="kd">private</span> <span class="kt">long</span> <span class="n">id</span><span class="o">;</span>
         <span class="kd">private</span> <span class="n">RecordWriter</span> <span class="n">recordWriter</span><span class="o">;</span>
         <span class="kd">private</span> <span class="n">Record</span> <span class="n">record</span><span class="o">;</span>
         <span class="kd">private</span> <span class="n">TableSchema</span> <span class="n">tableSchema</span><span class="o">;</span>

         <span class="kd">public</span> <span class="nf">UploadThread</span><span class="o">(</span><span class="kt">long</span> <span class="n">id</span><span class="o">,</span> <span class="n">RecordWriter</span> <span class="n">recordWriter</span><span class="o">,</span> <span class="n">Record</span> <span class="n">record</span><span class="o">,</span>
                         <span class="n">TableSchema</span> <span class="n">tableSchema</span><span class="o">)</span> <span class="o">{</span>
                 <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
                 <span class="k">this</span><span class="o">.</span><span class="na">recordWriter</span> <span class="o">=</span> <span class="n">recordWriter</span><span class="o">;</span>
                 <span class="k">this</span><span class="o">.</span><span class="na">record</span> <span class="o">=</span> <span class="n">record</span><span class="o">;</span>
                 <span class="k">this</span><span class="o">.</span><span class="na">tableSchema</span> <span class="o">=</span> <span class="n">tableSchema</span><span class="o">;</span>
         <span class="o">}</span>

         <span class="nd">@Override</span>
         <span class="kd">public</span> <span class="n">Boolean</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span>

                 <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tableSchema</span><span class="o">.</span><span class="na">getColumns</span><span class="o">().</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                         <span class="n">Column</span> <span class="n">column</span> <span class="o">=</span> <span class="n">tableSchema</span><span class="o">.</span><span class="na">getColumn</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                         <span class="k">switch</span> <span class="o">(</span><span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
                         <span class="k">case</span> <span class="nl">BIGINT:</span>
                                 <span class="n">record</span><span class="o">.</span><span class="na">setBigint</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="mi">1L</span><span class="o">);</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="k">case</span> <span class="nl">BOOLEAN:</span>
                                 <span class="n">record</span><span class="o">.</span><span class="na">setBoolean</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="k">case</span> <span class="nl">DATETIME:</span>
                                 <span class="n">record</span><span class="o">.</span><span class="na">setDatetime</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="k">case</span> <span class="nl">DOUBLE:</span>
                                 <span class="n">record</span><span class="o">.</span><span class="na">setDouble</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">);</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="k">case</span> <span class="nl">STRING:</span>
                                 <span class="n">record</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="s">&quot;sample&quot;</span><span class="o">);</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="k">default</span><span class="o">:</span>
                                 <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">&quot;Unknown column type: &quot;</span>
                                                 <span class="o">+</span> <span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">());</span>
                         <span class="o">}</span>
                 <span class="o">}</span>

                 <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                         <span class="k">try</span> <span class="o">{</span>
                                 <span class="n">recordWriter</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">record</span><span class="o">);</span>
                                 <span class="n">recordWriter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                         <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                                 <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                                 <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
                         <span class="o">}</span>
                 <span class="o">}</span>
                 <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
         <span class="o">}</span>

 <span class="o">}</span>

 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">UploadThreadSample</span> <span class="o">{</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessId</span> <span class="o">=</span> <span class="s">&quot;&lt;your access id&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessKey</span> <span class="o">=</span> <span class="s">&quot;&lt;your access Key&gt;&quot;</span><span class="o">;</span>
         <span class="cm">/*</span>
<span class="cm">          * Tunnel服务内网地址：http://dt-ext.odps.aliyun-inc.com</span>
<span class="cm">          * Tunnel服务公网地址：http://dt.odps.aliyun.com</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">tunnelUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your tunnel endpoint&gt;&quot;</span><span class="o">;</span>

         <span class="cm">/*</span>
<span class="cm">          * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm">          * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>


         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">project</span> <span class="o">=</span> <span class="s">&quot;&lt;your project&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">table</span> <span class="o">=</span> <span class="s">&quot;&lt;your table name&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">partition</span> <span class="o">=</span> <span class="s">&quot;&lt;your partition spec&gt;&quot;</span><span class="o">;</span>

         <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">threadNum</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>

         <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
                 <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="n">accessId</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">);</span>
                 <span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="n">project</span><span class="o">);</span>
                 <span class="k">try</span> <span class="o">{</span>
                         <span class="n">DataTunnel</span> <span class="n">tunnel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataTunnel</span><span class="o">(</span><span class="n">odps</span><span class="o">);</span>
                         <span class="n">tunnel</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">tunnelUrl</span><span class="o">);</span>
                         <span class="n">PartitionSpec</span> <span class="n">partitionSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PartitionSpec</span><span class="o">(</span><span class="n">partition</span><span class="o">);</span>
                         <span class="n">UploadSession</span> <span class="n">uploadSession</span> <span class="o">=</span> <span class="n">tunnel</span><span class="o">.</span><span class="na">createUploadSession</span><span class="o">(</span><span class="n">project</span><span class="o">,</span>
                                         <span class="n">table</span><span class="o">,</span> <span class="n">partitionSpec</span><span class="o">);</span>

                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Session Status is : &quot;</span>
                                         <span class="o">+</span> <span class="n">uploadSession</span><span class="o">.</span><span class="na">getStatus</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

                         <span class="n">ExecutorService</span> <span class="n">pool</span> <span class="o">=</span> <span class="n">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="n">threadNum</span><span class="o">);</span>
                         <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;&gt;</span> <span class="n">callers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;&gt;();</span>
                         <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">threadNum</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                                 <span class="n">RecordWriter</span> <span class="n">recordWriter</span> <span class="o">=</span> <span class="n">uploadSession</span><span class="o">.</span><span class="na">openRecordWriter</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">Record</span> <span class="n">record</span> <span class="o">=</span> <span class="n">uploadSession</span><span class="o">.</span><span class="na">newRecord</span><span class="o">();</span>
                                 <span class="n">callers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">UploadThread</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">recordWriter</span><span class="o">,</span> <span class="n">record</span><span class="o">,</span>
                                                 <span class="n">uploadSession</span><span class="o">.</span><span class="na">getSchema</span><span class="o">()));</span>
                         <span class="o">}</span>


                         <span class="n">pool</span><span class="o">.</span><span class="na">invokeAll</span><span class="o">(</span><span class="n">callers</span><span class="o">);</span>
                         <span class="n">pool</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>

                         <span class="n">Long</span><span class="o">[]</span> <span class="n">blockList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Long</span><span class="o">[</span><span class="n">threadNum</span><span class="o">];</span>
                         <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">threadNum</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
                                 <span class="n">blockList</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                         <span class="n">uploadSession</span><span class="o">.</span><span class="na">commit</span><span class="o">(</span><span class="n">blockList</span><span class="o">);</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;upload success!&quot;</span><span class="o">);</span>

                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">TunnelException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span>
         <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id4">
<h2>多线程下载示例<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167</pre></div></td><td class="code"><div class="highlight"><pre> <span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutionException</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutorService</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.Executors</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">java.util.concurrent.Future</span><span class="o">;</span>

 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Column</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.Odps</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.PartitionSpec</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.TableSchema</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.Account</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.account.AliyunAccount</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.Record</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.data.RecordReader</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.DataTunnel</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.DownloadSession</span><span class="o">;</span>
 <span class="kn">import</span> <span class="nn">com.aliyun.odps.tunnel.TunnelException</span><span class="o">;</span>

 <span class="kd">class</span> <span class="nc">DownloadThread</span> <span class="kd">implements</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="o">{</span>
         <span class="kd">private</span> <span class="kt">long</span> <span class="n">id</span><span class="o">;</span>
         <span class="kd">private</span> <span class="n">RecordReader</span> <span class="n">recordReader</span><span class="o">;</span>
         <span class="kd">private</span> <span class="n">TableSchema</span> <span class="n">tableSchema</span><span class="o">;</span>

         <span class="kd">public</span> <span class="nf">DownloadThread</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span>
                         <span class="n">RecordReader</span> <span class="n">recordReader</span><span class="o">,</span> <span class="n">TableSchema</span> <span class="n">tableSchema</span><span class="o">)</span> <span class="o">{</span>
                 <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
                 <span class="k">this</span><span class="o">.</span><span class="na">recordReader</span> <span class="o">=</span> <span class="n">recordReader</span><span class="o">;</span>
                 <span class="k">this</span><span class="o">.</span><span class="na">tableSchema</span> <span class="o">=</span> <span class="n">tableSchema</span><span class="o">;</span>
         <span class="o">}</span>

         <span class="nd">@Override</span>
         <span class="kd">public</span> <span class="n">Long</span> <span class="nf">call</span><span class="o">()</span> <span class="o">{</span>
                 <span class="n">Long</span> <span class="n">recordNum</span> <span class="o">=</span> <span class="mi">0L</span><span class="o">;</span>
                 <span class="k">try</span> <span class="o">{</span>
                         <span class="n">Record</span> <span class="n">record</span><span class="o">;</span>
                         <span class="k">while</span> <span class="o">((</span><span class="n">record</span> <span class="o">=</span> <span class="n">recordReader</span><span class="o">.</span><span class="na">read</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                 <span class="n">recordNum</span><span class="o">++;</span>
                                 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;Thread &quot;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span> <span class="s">&quot;\t&quot;</span><span class="o">);</span>
                                 <span class="n">consumeRecord</span><span class="o">(</span><span class="n">record</span><span class="o">,</span> <span class="n">tableSchema</span><span class="o">);</span>
                         <span class="o">}</span>
                         <span class="n">recordReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span>
                 <span class="k">return</span> <span class="n">recordNum</span><span class="o">;</span>
         <span class="o">}</span>

         <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">consumeRecord</span><span class="o">(</span><span class="n">Record</span> <span class="n">record</span><span class="o">,</span> <span class="n">TableSchema</span> <span class="n">schema</span><span class="o">)</span> <span class="o">{</span>
                 <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumns</span><span class="o">().</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                         <span class="n">Column</span> <span class="n">column</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumn</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                         <span class="n">String</span> <span class="n">colValue</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
                         <span class="k">switch</span> <span class="o">(</span><span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
                         <span class="k">case</span> <span class="nl">BIGINT:</span> <span class="o">{</span>
                                 <span class="n">Long</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getBigint</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">BOOLEAN:</span> <span class="o">{</span>
                                 <span class="n">Boolean</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">DATETIME:</span> <span class="o">{</span>
                                 <span class="n">Date</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getDatetime</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">DOUBLE:</span> <span class="o">{</span>
                                 <span class="n">Double</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getDouble</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">case</span> <span class="nl">STRING:</span> <span class="o">{</span>
                                 <span class="n">String</span> <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
                                 <span class="n">colValue</span> <span class="o">=</span> <span class="n">v</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">v</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
                                 <span class="k">break</span><span class="o">;</span>
                         <span class="o">}</span>
                         <span class="k">default</span><span class="o">:</span>
                                 <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">&quot;Unknown column type: &quot;</span>
                                                 <span class="o">+</span> <span class="n">column</span><span class="o">.</span><span class="na">getType</span><span class="o">());</span>
                         <span class="o">}</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">colValue</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="s">&quot;null&quot;</span> <span class="o">:</span> <span class="n">colValue</span><span class="o">);</span>
                         <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">schema</span><span class="o">.</span><span class="na">getColumns</span><span class="o">().</span><span class="na">size</span><span class="o">())</span>
                                 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">&quot;\t&quot;</span><span class="o">);</span>
                 <span class="o">}</span>
                 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
         <span class="o">}</span>

 <span class="o">}</span>

 <span class="kd">public</span> <span class="kd">class</span> <span class="nc">DownloadThreadSample</span> <span class="o">{</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessId</span> <span class="o">=</span> <span class="s">&quot;&lt;your access id&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">accessKey</span> <span class="o">=</span> <span class="s">&quot;&lt;your access Key&gt;&quot;</span><span class="o">;</span>
         <span class="cm">/*</span>
<span class="cm">          * Tunnel服务内网地址：http://dt-ext.odps.aliyun-inc.com</span>
<span class="cm">          * Tunnel服务公网地址：http://dt.odps.aliyun.com</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">tunnelUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your tunnel endpoint&gt;&quot;</span><span class="o">;</span>

         <span class="cm">/*</span>
<span class="cm">          * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm">          * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm">          */</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>


         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">project</span> <span class="o">=</span> <span class="s">&quot;&lt;your project&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">table</span> <span class="o">=</span> <span class="s">&quot;&lt;your table name&gt;&quot;</span><span class="o">;</span>
         <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">partition</span> <span class="o">=</span> <span class="s">&quot;&lt;your partition spec&gt;&quot;</span><span class="o">;</span>

         <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">threadNum</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>

         <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>
                 <span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="n">accessId</span><span class="o">,</span> <span class="n">accessKey</span><span class="o">);</span>
                 <span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
                 <span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="n">project</span><span class="o">);</span>
                 <span class="n">DataTunnel</span> <span class="n">tunnel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DataTunnel</span><span class="o">(</span><span class="n">odps</span><span class="o">);</span>
                 <span class="n">tunnel</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">tunnelUrl</span><span class="o">);</span>
                 <span class="n">PartitionSpec</span> <span class="n">partitionSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PartitionSpec</span><span class="o">(</span><span class="n">partition</span><span class="o">);</span>
                 <span class="n">DownloadSession</span> <span class="n">downloadSession</span><span class="o">;</span>
                 <span class="k">try</span> <span class="o">{</span>
                         <span class="n">downloadSession</span> <span class="o">=</span> <span class="n">tunnel</span><span class="o">.</span><span class="na">createDownloadSession</span><span class="o">(</span><span class="n">project</span><span class="o">,</span> <span class="n">table</span><span class="o">,</span>
                                         <span class="n">partitionSpec</span><span class="o">);</span>

                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Session Status is : &quot;</span>
                                         <span class="o">+</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">getStatus</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>

                         <span class="kt">long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">getRecordCount</span><span class="o">();</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;RecordCount is: &quot;</span> <span class="o">+</span> <span class="n">count</span><span class="o">);</span>

                         <span class="n">ExecutorService</span> <span class="n">pool</span> <span class="o">=</span> <span class="n">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="n">threadNum</span><span class="o">);</span>
                         <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;&gt;</span> <span class="n">callers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;&gt;();</span>

                         <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                         <span class="kt">long</span> <span class="n">step</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">threadNum</span><span class="o">;</span>
                         <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">threadNum</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
                                 <span class="n">RecordReader</span> <span class="n">recordReader</span> <span class="o">=</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">openRecordReader</span><span class="o">(</span>
                                                 <span class="n">start</span> <span class="o">*</span> <span class="n">i</span><span class="o">,</span> <span class="n">step</span><span class="o">);</span>
                                 <span class="n">callers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">DownloadThread</span><span class="o">(</span> <span class="n">i</span><span class="o">,</span> <span class="n">recordReader</span><span class="o">,</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">getSchema</span><span class="o">()));</span>
                         <span class="o">}</span>
                         <span class="n">RecordReader</span> <span class="n">recordReader</span> <span class="o">=</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">openRecordReader</span><span class="o">(</span><span class="n">start</span> <span class="o">*</span> <span class="o">(</span><span class="n">threadNum</span> <span class="o">-</span> <span class="mi">1</span><span class="o">),</span> <span class="n">count</span>
                                         <span class="o">-</span> <span class="o">((</span><span class="n">threadNum</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">*</span> <span class="n">step</span><span class="o">));</span>
                         <span class="n">callers</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">DownloadThread</span><span class="o">(</span> <span class="n">threadNum</span> <span class="o">-</span> <span class="mi">1</span><span class="o">,</span> <span class="n">recordReader</span><span class="o">,</span> <span class="n">downloadSession</span><span class="o">.</span><span class="na">getSchema</span><span class="o">()));</span>

                         <span class="n">Long</span> <span class="n">downloadNum</span> <span class="o">=</span> <span class="mi">0L</span><span class="o">;</span>
                         <span class="n">List</span><span class="o">&lt;</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;&gt;</span> <span class="n">recordNum</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="na">invokeAll</span><span class="o">(</span><span class="n">callers</span><span class="o">);</span>
                         <span class="k">for</span> <span class="o">(</span><span class="n">Future</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">num</span> <span class="o">:</span> <span class="n">recordNum</span><span class="o">)</span>
                                 <span class="n">downloadNum</span> <span class="o">+=</span> <span class="n">num</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
                         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Record Count is: &quot;</span> <span class="o">+</span> <span class="n">downloadNum</span><span class="o">);</span>
                         <span class="n">pool</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>

                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">TunnelException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ExecutionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                         <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                 <span class="o">}</span>
         <span class="o">}</span>
 <span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tunnel SDK 示例</a><ul>
<li><a class="reference internal" href="#id1">简单上传示例</a></li>
<li><a class="reference internal" href="#id2">简单下载示例</a></li>
<li><a class="reference internal" href="#id3">多线程上传示例</a></li>
<li><a class="reference internal" href="#id4">多线程下载示例</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../odps_sdk/sdk.html" title="ODPS SDK介绍"
             >next</a></li>
        <li class="right" >
          <a href="odps_tunnel_summary.html" title="Tunnel SDK简介"
             >previous</a> |</li>
        <li><a href="../../index.html">ODPS 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >ODPS TUNNEL</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Alibaba 2014-07-01.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b1.
    </div>
  <!-- 请把脚本放到 body 元素内 -->
  </body>
</html>