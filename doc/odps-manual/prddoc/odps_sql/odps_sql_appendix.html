<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>附录 &mdash; ODPS 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ODPS 1.0 documentation" href="../../index.html" />
    <link rel="up" title="ODPS SQL" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../odps_mr/index.html" title="MapReduce"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="odps_sql_udf.html" title="自定义函数(UDF)"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">ODPS 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">ODPS SQL</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="id1">
<h1>附录<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>在ODPS SQL中的字符串常量可以用单引号或双引号表示，可以在单引号括起的字符串中包含双引号，或在双引号括起的字符串中包含单引号，否则要用转义符来表达，如以下表达方式都是可以的</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&quot;I&#39;m a happy manong!&quot;</span>
<span class="s">&#39;I</span><span class="se">\&#39;</span><span class="s">m a happy manong!&#39;</span>
</pre></div>
</div>
<p>在ODPS SQL中反斜线&#8221;\&#8221;是转义符，用来表达字符串中的特殊字符，或将其后跟的字符解释为其本身。当读入字符串常量时，如果反斜线后跟三位有效的8进制数字，范围在001 ~177之间，系统会根据ASCII值转为相应的字符。对于以下情况，则会将其解释为特殊字符：</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">转义</th>
<th class="head">字符</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>\b</td>
<td>backspace</td>
</tr>
<tr class="row-odd"><td>\t</td>
<td>tab</td>
</tr>
<tr class="row-even"><td>\n</td>
<td>newline</td>
</tr>
<tr class="row-odd"><td>\r</td>
<td>carriage-return</td>
</tr>
<tr class="row-even"><td>\&#8217;</td>
<td>单引号</td>
</tr>
<tr class="row-odd"><td>\&#8221;</td>
<td>双引号</td>
</tr>
<tr class="row-even"><td>\ \</td>
<td>反斜线</td>
</tr>
<tr class="row-odd"><td>\;</td>
<td>分号</td>
</tr>
<tr class="row-even"><td>\Z</td>
<td>control-Z</td>
</tr>
<tr class="row-odd"><td>\0或\00</td>
<td>结束符</td>
</tr>
</tbody>
</table>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">select</span> <span class="k">length</span><span class="p">(</span><span class="s1">&#39;a\tb&#39;</span><span class="p">)</span> <span class="k">from</span> <span class="n">dual</span><span class="p">;</span>
</pre></div>
</div>
<p>结果是3，表示字符串里实际有三个字符,&#8221;\t&#8221;被视为一个字符。在转义符后的其它字符被解释为其本身。</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">select</span> <span class="s1">&#39;a\ab&#39;</span><span class="p">,</span><span class="k">length</span><span class="p">(</span><span class="s1">&#39;a\ab&#39;</span><span class="p">)</span> <span class="k">from</span> <span class="n">dual</span><span class="p">;</span>
</pre></div>
</div>
<p>结果是&#8217;aab&#8217;, 3。&#8221;\a&#8221;被解释成了普通的&#8221;a&#8221;。</p>
<div class="section" id="like">
<h2>LIKE字符匹配<a class="headerlink" href="#like" title="Permalink to this headline">¶</a></h2>
<p>在LIKE匹配时，&#8221;%&#8221;表示匹配任意多个字符，&#8221;_&#8221;表示匹配单个字符，如果要匹配&#8221;%&#8221;或&#8221;_&#8221;本身，则要对其进行转义, &#8220;\\%&#8221;匹配字符&#8221;%&#8221;， &#8220;\\_&#8221;匹配字符&#8221;_&#8221;。</p>
<div class="highlight-python"><pre>'abcd' like 'ab%' -- true
'abcd' like 'ab\%' -- false
'ab%cd' like 'ab\\%%' -- true</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">关于字符串的字符集，目前ODPS SQL支持UTF-8的字符集，如果数据是以其它格式编码，可能计算出的结果不正确。</p>
</div>
</div>
<div class="section" id="id2">
<h2>正则表达式规范<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>ODPS SQL中的正则表达式采用的是PCRE的规范，匹配时是按字符进行，支持的元字符如下：</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">元字符</th>
<th class="head">说明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>^</td>
<td>行首</td>
</tr>
<tr class="row-odd"><td>$</td>
<td>行尾</td>
</tr>
<tr class="row-even"><td>.</td>
<td>任意字符</td>
</tr>
<tr class="row-odd"><td>*</td>
<td>匹配零次或多次</td>
</tr>
<tr class="row-even"><td>+</td>
<td>匹配1次或多次</td>
</tr>
<tr class="row-odd"><td>?</td>
<td>匹配零次或1次</td>
</tr>
<tr class="row-even"><td>?</td>
<td>匹配修饰符，当该字符紧跟在任何一个其他限制符
(* ,+, ?, {n}, {n,}, {n,m})后面时，匹配模式是非贪
婪的。非贪婪模式尽可能少的匹配所搜索的字符串，
而默认的贪婪模式则尽可能多的匹配所搜索的字符串。</td>
</tr>
<tr class="row-odd"><td>A|B</td>
<td>A或B</td>
</tr>
<tr class="row-even"><td>(abc)*</td>
<td>匹配abc序列零次或多次</td>
</tr>
<tr class="row-odd"><td>{n}或{m,n}</td>
<td>匹配的次数</td>
</tr>
<tr class="row-even"><td>[ab]</td>
<td>匹配括号中的任一字符,例中模式匹配a或b</td>
</tr>
<tr class="row-odd"><td>[a-d]</td>
<td>匹配a,b,c,d任一字符</td>
</tr>
<tr class="row-even"><td>[^ab]</td>
<td>^表示非，匹配任一非a非 b的字符</td>
</tr>
<tr class="row-odd"><td>[::]</td>
<td>见下表POSIX字符组</td>
</tr>
<tr class="row-even"><td>\</td>
<td>转义符</td>
</tr>
<tr class="row-odd"><td>\n</td>
<td>n为数字1-9，后向引用</td>
</tr>
<tr class="row-even"><td>\d</td>
<td>数字</td>
</tr>
<tr class="row-odd"><td>\D</td>
<td>非数字</td>
</tr>
</tbody>
</table>
<p>POSIX字符组</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="2%" />
<col width="30%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">POSIX字符组</th>
<th class="head">说明</th>
<th class="head">范围</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="2">[[:alnum:]]</td>
<td>字母字符和数字字符</td>
<td>[a-zA-Z0-9]</td>
</tr>
<tr class="row-odd"><td colspan="2">[[:alpha:]]</td>
<td>字母</td>
<td>[a-zA-Z]</td>
</tr>
<tr class="row-even"><td colspan="2">[[:ascii:]]</td>
<td>ASCII字符</td>
<td>[\x00-\x7F]</td>
</tr>
<tr class="row-odd"><td colspan="2">[[:blank:]]</td>
<td>空格字符和制表符</td>
<td>[ \t]</td>
</tr>
<tr class="row-even"><td colspan="2">[[:cntrl:]]</td>
<td>控制字符</td>
<td>[\x00-\x1F\x7F]</td>
</tr>
<tr class="row-odd"><td colspan="2">[[:digit:]]</td>
<td>数字字符</td>
<td>[0-9]</td>
</tr>
<tr class="row-even"><td colspan="2">[[:graph:]]</td>
<td>空白字符之外的字符</td>
<td>[\x21-\x7E]</td>
</tr>
<tr class="row-odd"><td colspan="2">[[:lower:]]</td>
<td>小写字母字符</td>
<td>[a-z]</td>
</tr>
<tr class="row-even"><td colspan="2">[[:print:]]</td>
<td>[:graph:]和空白字符</td>
<td>[\x20-\x7E]</td>
</tr>
<tr class="row-odd"><td colspan="2">[[:punct:]]</td>
<td>标点符号</td>
<td>[][!&#8221;#$%&amp;&#8217;()*+,./:;&lt;=&gt;?
&#64;\^_`{|}~-]</td>
</tr>
<tr class="row-even"><td colspan="2">[[:space:]]</td>
<td>空白字符</td>
<td>[ \t\r\n\v\f]</td>
</tr>
<tr class="row-odd"><td colspan="2">[[:upper:]]</td>
<td>大写字母字符</td>
<td>[A-Z]</td>
</tr>
<tr class="row-even"><td colspan="3">[[:xdigit:]]| 十六进制字符</td>
<td>[A-Fa-f0-9]</td>
</tr>
</tbody>
</table>
<p>由于系统采用反斜线&#8221;\&#8221;作为转义符，因此正则表达式的模式中出现的&#8221;\&#8221;都要进行二次转义。如正则表达式要匹配字符串&#8221;a+b&#8221;，其中&#8221;+&#8221;是正则中的一个特殊字符，因此要用转义的方式表达，在正则引擎中的表达方式是&#8221;a\+b&#8221;，由于系统还要解释一层转义，因此能够匹配该字符串的表达式是&#8221;a\\+b&#8221;。例如，假设存在表test_dual，</p>
<div class="highlight-python"><pre>select 'a+b' rlike 'a\\+b' from test_dual;

+------+
| _c1  |
+------+
| true |
+------+</pre>
</div>
<p>极端的情况，如果在要匹配字符&#8221;\&#8221;， 由于在正则引擎中&#8221;\&#8221;是一个特殊字符，因此要表示为&#8221;\\&#8221;，而系统还要对表达式进行一次转义，因此写成&#8221;\\\\&#8221;</p>
<div class="highlight-python"><pre>select 'a\\b', 'a\\b' rlike 'a\\\\b' from test_dual;

+-----+------+
| _c0 | _c1  |
+-----+------+
| a\b | true |
+-----+------+</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">在ODPS SQL中写&#8221;a\\b&#8221;， 而在输出结果中显示&#8217;a\b&#8217;，同样是因为ODPS会对表达式进行转意。</p>
</div>
<p>如果字符串中有制表符TAB, 系统在读入&#8217;\t&#8217;这两个字符的时候，即已经将其存为一个字符，因此在正则的模式中也是一个普通的字符。</p>
<div class="highlight-python"><pre>select 'a\tb', 'a\tb' rlike 'a\tb' from test_dual;

+---------+------+
| _c0     | _c1  |
+---------+------+
| a     b | true |
+---------+------+</pre>
</div>
</div>
<div class="section" id="odps-sql">
<span id="odps-keyword"></span><h2>ODPS SQL保留字<a class="headerlink" href="#odps-sql" title="Permalink to this headline">¶</a></h2>
<p>以下ODPS SQL的全部保留字，在对表、列或是分区命名时请不要使用，否则会报错。保留字不区分大小写。</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="13%" />
<col width="13%" />
<col width="16%" />
<col width="12%" />
<col width="20%" />
<col width="14%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>%</td>
<td>&amp;</td>
<td>&amp;&amp;</td>
<td>(</td>
<td>)</td>
<td>*</td>
<td>+</td>
</tr>
<tr class="row-even"><td>-</td>
<td>.</td>
<td>/</td>
<td>;</td>
<td>&lt;</td>
<td>&lt;=</td>
<td>&lt;&gt;</td>
</tr>
<tr class="row-odd"><td>=</td>
<td>&gt;</td>
<td>&gt;=</td>
<td>?</td>
<td>ADD</td>
<td>AFTER</td>
<td>ALL</td>
</tr>
<tr class="row-even"><td>ALTER</td>
<td>ANALYZE</td>
<td>AND</td>
<td>ARCHIVE</td>
<td>ARRAY</td>
<td>AS</td>
<td>ASC</td>
</tr>
<tr class="row-odd"><td>BEFORE</td>
<td>BETWEEN</td>
<td>BIGINT</td>
<td>BINARY</td>
<td>BLOB</td>
<td>BOOLEAN</td>
<td>BOTH</td>
</tr>
<tr class="row-even"><td>BUCKET</td>
<td>BUCKETS</td>
<td>BY</td>
<td>CASCADE</td>
<td>CASE</td>
<td>CAST</td>
<td>CFILE</td>
</tr>
<tr class="row-odd"><td>CHANGE</td>
<td>CLUSTER</td>
<td>CLUSTERED</td>
<td>CLUSTERSTATUS</td>
<td>COLLECTION</td>
<td>COLUMN</td>
<td>COLUMNS</td>
</tr>
<tr class="row-even"><td>COMMENT</td>
<td>COMPUTE</td>
<td>CONCATENATE</td>
<td>CONTINUE</td>
<td>CREATE</td>
<td>CROSS</td>
<td>CURRENT</td>
</tr>
<tr class="row-odd"><td>CURSOR</td>
<td>DATA</td>
<td>DATABASE</td>
<td>DATABASES</td>
<td>DATE</td>
<td>DATETIME</td>
<td>DBPROPERTIES</td>
</tr>
<tr class="row-even"><td>DEFERRED</td>
<td>DELETE</td>
<td>DELIMITED</td>
<td>DESC</td>
<td>DESCRIBE</td>
<td>DIRECTORY</td>
<td>DISABLE</td>
</tr>
<tr class="row-odd"><td>DISTINCT</td>
<td>DISTRIBUTE</td>
<td>DOUBLE</td>
<td>DROP</td>
<td>ELSE</td>
<td>ENABLE</td>
<td>END</td>
</tr>
<tr class="row-even"><td>ESCAPED</td>
<td>EXCLUSIVE</td>
<td>EXISTS</td>
<td>EXPLAIN</td>
<td>EXPORT</td>
<td>EXTENDED</td>
<td>EXTERNAL</td>
</tr>
<tr class="row-odd"><td>FALSE</td>
<td>FETCH</td>
<td>FIELDS</td>
<td>FILEFORMAT</td>
<td>FIRST</td>
<td>FLOAT</td>
<td>FOLLOWING</td>
</tr>
<tr class="row-even"><td>FORMAT</td>
<td>FORMATTED</td>
<td>FROM</td>
<td>FULL</td>
<td>FUNCTION</td>
<td>FUNCTIONS</td>
<td>GRANT</td>
</tr>
<tr class="row-odd"><td>GROUP</td>
<td>HAVING</td>
<td>HOLD_DDLTIME</td>
<td>IDXPROPERTIES</td>
<td>IF</td>
<td>IMPORT</td>
<td>IN</td>
</tr>
<tr class="row-even"><td>INDEX</td>
<td>INDEXES</td>
<td>INPATH</td>
<td>INPUTDRIVER</td>
<td>INPUTFORMAT</td>
<td>INSERT</td>
<td>INT</td>
</tr>
<tr class="row-odd"><td>INTERSECT</td>
<td>INTO</td>
<td>IS</td>
<td>ITEMS</td>
<td>JOIN</td>
<td>KEYS</td>
<td>LATERAL</td>
</tr>
<tr class="row-even"><td>LEFT</td>
<td>LIFECYCLE</td>
<td>LIKE</td>
<td>LIMIT</td>
<td>LINES</td>
<td>LOAD</td>
<td>LOCAL</td>
</tr>
<tr class="row-odd"><td>LOCATION</td>
<td>LOCK</td>
<td>LOCKS</td>
<td>LONG</td>
<td>MAP</td>
<td>MAPJOIN</td>
<td>MATERIALIZED</td>
</tr>
<tr class="row-even"><td>MINUS</td>
<td>MSCK</td>
<td>NOT</td>
<td>NO_DROP</td>
<td>NULL</td>
<td>OF</td>
<td>OFFLINE</td>
</tr>
<tr class="row-odd"><td>ON</td>
<td>OPTION</td>
<td>OR</td>
<td>ORDER</td>
<td>OUT</td>
<td>OUTER</td>
<td>OUTPUTDRIVER</td>
</tr>
<tr class="row-even"><td>OUTPUTFORMAT</td>
<td>OVER</td>
<td>OVERWRITE</td>
<td>PARTITION</td>
<td>PARTITIONED</td>
<td>PARTITIONPROPERTIES</td>
<td>PARTITIONS</td>
</tr>
<tr class="row-odd"><td>PERCENT</td>
<td>PLUS</td>
<td>PRECEDING</td>
<td>PRESERVE</td>
<td>PROCEDURE</td>
<td>PURGE</td>
<td>RANGE</td>
</tr>
<tr class="row-even"><td>RCFILE</td>
<td>READ</td>
<td>READONLY</td>
<td>READS</td>
<td>REBUILD</td>
<td>RECORDREADER</td>
<td>RECORDWRITER</td>
</tr>
<tr class="row-odd"><td>REDUCE</td>
<td>REGEXP</td>
<td>RENAME</td>
<td>REPAIR</td>
<td>REPLACE</td>
<td>RESTRICT</td>
<td>REVOKE</td>
</tr>
<tr class="row-even"><td>RIGHT</td>
<td>RLIKE</td>
<td>ROW</td>
<td>ROWS</td>
<td>SCHEMA</td>
<td>SCHEMAS</td>
<td>SELECT</td>
</tr>
<tr class="row-odd"><td>SEMI</td>
<td>SEQUENCEFILE</td>
<td>SERDE</td>
<td>SERDEPROPERTIES</td>
<td>SET</td>
<td>SHARED</td>
<td>SHOW</td>
</tr>
<tr class="row-even"><td>SHOW_DATABASE</td>
<td>SMALLINT</td>
<td>SORT</td>
<td>SORTED</td>
<td>SSL</td>
<td>STATISTICS</td>
<td>STORED</td>
</tr>
<tr class="row-odd"><td>STREAMTABLE</td>
<td>STRING</td>
<td>STRUCT</td>
<td>TABLE</td>
<td>TABLES</td>
<td>TABLESAMPLE</td>
<td>TBLPROPERTIES</td>
</tr>
<tr class="row-even"><td>TEMPORARY</td>
<td>TERMINATED</td>
<td>TEXTFILE</td>
<td>THEN</td>
<td>TIMESTAMP</td>
<td>TINYINT</td>
<td>TO</td>
</tr>
<tr class="row-odd"><td>TOUCH</td>
<td>TRANSFORM</td>
<td>TRIGGER</td>
<td>TRUE</td>
<td>UNARCHIVE</td>
<td>UNBOUNDED</td>
<td>UNDO</td>
</tr>
<tr class="row-even"><td>UNION</td>
<td>UNIONTYPE</td>
<td>UNIQUEJOIN</td>
<td>UNLOCK</td>
<td>UNSIGNED</td>
<td>UPDATE</td>
<td>USE</td>
</tr>
<tr class="row-odd"><td>USING</td>
<td>UTC</td>
<td>UTC_TMESTAMP</td>
<td>VIEW</td>
<td>WHEN</td>
<td>WHERE</td>
<td>WHILE</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">附录</a><ul>
<li><a class="reference internal" href="#like">LIKE字符匹配</a></li>
<li><a class="reference internal" href="#id2">正则表达式规范</a></li>
<li><a class="reference internal" href="#odps-sql">ODPS SQL保留字</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../odps_mr/index.html" title="MapReduce"
             >next</a></li>
        <li class="right" >
          <a href="odps_sql_udf.html" title="自定义函数(UDF)"
             >previous</a> |</li>
        <li><a href="../../index.html">ODPS 1.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >ODPS SQL</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Alibaba 2014-07-01.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b1.
    </div>
  <!-- 请把脚本放到 body 元素内 -->
  </body>
</html>