<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ODPS 基本概念及常用命令 &mdash; ODPS 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ODPS 1.0 documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="odps_sql/index.html" title="ODPS SQL"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../index.html" title="ODPS产品文档中心"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">ODPS 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="odps">
<h1>ODPS 基本概念及常用命令<a class="headerlink" href="#odps" title="Permalink to this headline">¶</a></h1>
<p>开放数据处理服务(Open Data Processing Service，简称ODPS)是阿里巴巴自主研发的海量数据离线数据处理平台。主要服务于实时性要求相对不高的批量结构化数据的存储和计算，可以提供海量数据仓库的解决方案以及针对大数据的分析建模服务。</p>
<p>ODPS提供了数据上传下载通道，SQL及MapReduce等多种计算分析服务，并且提供了完善的安全解决方案，其包括的功能有:</p>
<ul class="simple">
<li>数据通道：提供高并发的数据上传下载服务，<a class="reference internal" href="odps_tunnel/index.html#odps-tunnel"><em>ODPS TUNNEL</em></a> ；</li>
<li>计算及分析任务：<a class="reference internal" href="odps_sql/index.html#odps-sql"><em>ODPS SQL</em></a> 及 <a class="reference internal" href="odps_mr/index.html#odps-open-mr"><em>MapReduce</em></a>  ；</li>
<li>SDK：提供给开发者的工具包，SDK的相关介绍请参考 <a class="reference internal" href="odps_sdk/sdk.html#odps-sdk"><em>ODPS SDK介绍</em></a> ；</li>
<li>安全：ODPS提供了功能强大的安全服务，为用户的数据安全提供保护，详情请参考 <a class="reference internal" href="odps_security/index.html#odps-security"><em>ODPS 安全参考手册</em></a> ；</li>
</ul>
<p>各个功能模型的描述请参考用手册的其他部分。如果想快速了解如何使用ODPS，请参考 <a class="reference internal" href="#odps-pre-case-tunnel"><em>快速开始</em></a></p>
<div class="section" id="id1">
<h2>ODPS基本概念<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="project">
<span id="odps-common-project"></span><h3>项目空间(Project)<a class="headerlink" href="#project" title="Permalink to this headline">¶</a></h3>
<p>在ODPS中，所有对象都是属于某个项目空间的。一个用户可以同时拥有多个项目空间的权限。通过安全授权，可以在一个项目空间中访问另一个项目空间中的对象，例如：<a class="reference internal" href="#odps-common-table"><em>表(Table)</em></a> ，<a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> 等。</p>
<p>用户可以通过 <a class="reference internal" href="#odps-common-use-project"><em>Use Project</em></a> 命令进入一个项目空间，例如：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">use</span> <span class="n">my_project</span>   <span class="c1">-- 进入一个名为my_project的项目空间</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ODPS客户端并不支持注释功能，但在文档中为了方便读者阅读，使用&#8221;- -&#8220;作为注释。</p>
</div>
<p>命令此运行后，用户会进入一个名为my_project的项目空间，从而可以操作该项目空间下的对象，例如：<a class="reference internal" href="#odps-common-table"><em>表(Table)</em></a> ，<a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> ，<a class="reference internal" href="#odps-common-function"><em>自定义函数(UDF)</em></a> ，<a class="reference internal" href="#odps-common-instance"><em>实例(Instance)</em></a>  等，而不需要关心操作对象所在的项目空间。<a class="reference internal" href="#odps-common-use-project"><em>Use Project</em></a> 是ODPS客户端提供的命令。在详细介绍这部分内容之前，文档会对这些命令做简短的介绍说明，具体说明请参考 <a class="reference internal" href="#odps-command"><em>ODPS常用命令</em></a> 。</p>
</div>
<div class="section" id="table">
<span id="odps-common-table"></span><h3>表(Table)<a class="headerlink" href="#table" title="Permalink to this headline">¶</a></h3>
<p>在ODPS中，所有的数据都被存储在表中。表中的列可以是ODPS支持的任意种数据类型(Bigint，Double，String，Boolean，Datetime)。ODPS中的各种不同类型计算任务的操作对象(输入、输出)都是表。用户可以创建表，删除表以及向表中导入数据。</p>
<p>为了提高处理效率，可以在创建表时指定表的分区(Partition)，即指定表内的某几个字段作为分区列。在大多数情况下，用户可以将分区类比为文件系统下的目录。ODPS将分区列的每个值作为一个分区(目录)。用户可以指定多级分区，即将表的多个字段作为表的分区，分区之间正如多级目录的关系。在使用数据时如果指定了需要访问的分区名称，则只会读取相应的分区，避免全表扫描，提高处理效率，降低费用。详细介绍请参见 <a class="reference internal" href="odps_sql/odps_sql_summary.html#odps-sql-part-table"><em>分区表</em></a> 中的介绍。</p>
</div>
<div class="section" id="data-type">
<h3>数据类型(Data Type)<a class="headerlink" href="#data-type" title="Permalink to this headline">¶</a></h3>
<p>ODPS表中的列必须是下列描述的任意一种类型，各种类型的描述及取值范围包括：</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="48%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">类型</th>
<th class="head">描述</th>
<th class="head">取值范围</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Bigint</td>
<td>8字节有符号整型。请不要使用整型的最小值
(-9223372036854775808)，这是系统保留值。</td>
<td>-9223372036854775807 ~ 9223372036854775807</td>
</tr>
<tr class="row-odd"><td>String</td>
<td>字符串，支持UTF-8编码。其他编码的字符行为未定义。
单个String列最长允许2M字节。</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Boolean</td>
<td>布尔型。</td>
<td>True/False</td>
</tr>
<tr class="row-odd"><td>Double</td>
<td>8字节双精度浮点数。</td>
<td>-1.0 * 10^308 ~ 1.0 * 10^308</td>
</tr>
<tr class="row-even"><td>Datetime</td>
<td>日期类型。使用东八区时间作为系统标准时间。</td>
<td>0001-01-01 00:00:00 ~ 9999-12-31 23:59:59</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">各种数据类型均可以为NULL</p>
</div>
</div>
<div class="section" id="resource">
<span id="odps-common-resource"></span><h3>资源(Resource)<a class="headerlink" href="#resource" title="Permalink to this headline">¶</a></h3>
<p>资源(Resource)是ODPS的特有概念。用户如果想使用ODPS的 <a class="reference internal" href="odps_sql/odps_sql_udf.html#odps-sql-udf"><em>自定义函数(UDF)</em></a> 或 <a class="reference internal" href="odps_mr/index.html#odps-open-mr"><em>MapReduce</em></a>  功能需要依赖资源来完成，例如：</p>
<ul class="simple">
<li>ODPS SQL UDF: 用户在编写UDF后，需要将编译好的jar包上传到ODPS。运行这个UDF时，ODPS会自动下载这个jar包，获取用户代码，运行UDF，无需用户干预。上传jar包的过程就是在ODPS上创建资源的过程，这个jar是ODPS资源的一种。</li>
<li>ODPS MapReduce: 用户编写MapReduce程序后，将编译好的jar包作为一种资源上传到ODPS。运行MapReduce作业时，MapReduce框架会自动下载这个jar资源，获取用户代码。</li>
<li>用户同样可以将文本文件以及ODPS中的表作为不同类型的资源上传到ODPS。用户可以在UDF及MapReduce的运行过程中读取、使用这些资源。ODPS提供了读取、使用资源的接口。详细示例请查看 <a class="reference internal" href="odps_mr/example/Resource.html#odps-mr-resource-set"><em>资源使用示例</em></a> 及 <a class="reference internal" href="odps_sql/odps_sql_udf.html#odps-udtf-usage"><em>UDTF使用说明</em></a> 中的描述。需要注意的是，ODPS的 <a class="reference internal" href="odps_sql/odps_sql_udf.html#odps-sql-udf"><em>自定义函数(UDF)</em></a> 或 <a class="reference internal" href="odps_mr/index.html#odps-open-mr"><em>MapReduce</em></a> 对资源的读取有如下 <a class="reference internal" href="odps_mr/odps_mr_restriction.html#odps-mr-restriction"><em>应用限制</em></a> 。</li>
</ul>
<p>ODPS资源的类型包括：</p>
<blockquote>
<div><ul class="simple">
<li>File类型；</li>
<li>Table类型：ODPS中的表；</li>
<li>Jar类型：编译好的Java Jar包；</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">有关资源的操作介绍请参阅 <a class="reference internal" href="#odps-common-add-resource-cmd"><em>创建资源</em></a> 、 <a class="reference internal" href="#odps-common-del-resource-cmd"><em>删除资源</em></a> 、 <a class="reference internal" href="#odps-common-list-resource-cmd"><em>查看资源清单</em></a> 及 <a class="reference internal" href="#odps-common-desc-resource-cmd"><em>查看资源信息</em></a> 。</p>
</div>
</div>
<div class="section" id="udf">
<span id="odps-common-function"></span><h3>自定义函数(UDF)<a class="headerlink" href="#udf" title="Permalink to this headline">¶</a></h3>
<p>ODPS为用户提供了SQL计算功能，用户可以在ODPS SQL中使用系统的 <a class="reference internal" href="odps_sql/odps_sql_func.html#odps-sql-function"><em>SQL内建函数</em></a> 完成一定的计算和计数功能。但当内建函数无法满足要求时，用户可以使用ODPS提供的Java编程接口开发自定义函数(User Defined Function，以下简称UDF)。<a class="reference internal" href="odps_sql/odps_sql_udf.html#odps-sql-udf"><em>自定义函数(UDF)</em></a> 又可以进一步分为标量值函数和自定义表值函数两种。</p>
<p>用户在开发完成UDF代码后，需要将代码编译成jar包，并将此jar包以jar资源的形式上传到ODPS，最后在ODPS中注册此UDF。在使用UDF时，只需要在SQL中指明UDF的函数名及输入参数即可，使用方式与ODPS提供的内建函数相同。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">有关UDF的操作请参考 <a class="reference internal" href="#odps-common-create-func"><em>创建函数</em></a> ， <a class="reference internal" href="#odps-common-del-func"><em>删除函数</em></a> 及 <a class="reference internal" href="#odps-common-ls-func"><em>查看函数清单</em></a> 。</p>
</div>
</div>
<div class="section" id="task">
<span id="odps-task"></span><h3>任务(Task)<a class="headerlink" href="#task" title="Permalink to this headline">¶</a></h3>
<p>任务(Task)是ODPS的基本计算单元。SQL及MapReduce功能都是通过任务(Task)完成的。</p>
<p>对于用户提交的大多数任务，特别是计算型任务，例如：SQL <a class="reference internal" href="odps_sql/odps_sql_grmr.html#odps-sql-dml"><em>DML语句</em></a> ，<a class="reference internal" href="odps_mr/index.html#odps-open-mr"><em>MapReduce</em></a> 等，ODPS会对其进行解析，得出任务的执行计划。执行计划是由具有依赖关系的多个执行阶段(Stage)构成的。目前，执行计划逻辑上可以被看做一个有向图，图中的点是执行阶段，各个执行阶段的依赖关系是图的边。ODPS会依照图(执行计划)中的依赖关系执行各个阶段。在同一个执行阶段内，会有多个进程，也称之为Worker，共同完成该执行阶段的计算工作。同一个执行阶段的不同Worker只是处理的数据不同，执行逻辑完全相同。计算型任务在执行时，会被实例化，用户可以操作这个 <a class="reference internal" href="#odps-common-instance"><em>实例(Instance)</em></a> 的信息，例如：获取实例状态( <a class="reference internal" href="#odps-common-status-ins"><em>Status Instance</em></a> )，终止实例运行( <a class="reference internal" href="#odps-common-kill-ins"><em>Kill Instance</em></a> )等。</p>
<p>另一方面，部分ODPS任务并不是计算型的任务，例如：SQL中的 <a class="reference internal" href="odps_sql/odps_sql_grmr.html#odps-sql-ddl"><em>DDL语句</em></a> ，这些任务本质上仅需要读取、修改ODPS中的元数据信息。因此，这些任务无法被解析出执行计划。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">在ODPS中，并不是所有的请求都会被转化为任务(Task)，例如：<a class="reference internal" href="#odps-common-project"><em>项目空间(Project)</em></a> 、 <a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> 、 <a class="reference internal" href="odps_sql/odps_sql_udf.html#odps-sql-udf"><em>自定义函数(UDF)</em></a> 及 <a class="reference internal" href="#odps-common-instance"><em>实例(Instance)</em></a> 的操作就不需要通过ODPS的任务来完成</p>
</div>
</div>
<div class="section" id="instance">
<span id="odps-common-instance"></span><h3>实例(Instance)<a class="headerlink" href="#instance" title="Permalink to this headline">¶</a></h3>
<p>在ODPS中，部分 <a class="reference internal" href="#odps-task"><em>任务(Task)</em></a> 在执行时会被实例化，以ODPS实例(下文简称实例或Instance)的形式存在。实例会经历运行(Running)及结束(Terminated)两个阶段。运行阶段的状态为Running(运行中)，而结束阶段的状态将会是Success(成功)，Failed(失败)或Canceled(被取消)。用户可以根据运行任务时ODPS给出的实例ID查询、改变任务的状态，例如：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">status</span> <span class="o">&lt;</span><span class="n">instance_id</span><span class="o">&gt;</span>          <span class="c1">--查看某实例的状态</span>
<span class="n">kill</span> <span class="o">&lt;</span><span class="n">instance_id</span><span class="o">&gt;</span>            <span class="c1">--停止某实例，将其状态设置为Canceled</span>
</pre></div>
</div>
</div>
<div class="section" id="security">
<h3>安全(Security)<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h3>
<p>在ODPS中访问数据，运行作业都必须有相应的权限。关于安全内容的介绍请参考 <a class="reference internal" href="odps_security/index.html#odps-security"><em>ODPS 安全参考手册</em></a> 章节的内容。</p>
</div>
</div>
<div class="section" id="odps-command">
<span id="id2"></span><h2>ODPS常用命令<a class="headerlink" href="#odps-command" title="Permalink to this headline">¶</a></h2>
<p>ODPS提供了对项目空间、表、资源及实例等对象的一系列操作。用户可以通过客户端命令及SDK操作这些的对象。为了帮助您快速了解ODPS，在本章节，我们将详细介绍如何通过客户端使用这些命令。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>如果想了解如何安装、配置客户端，请参考 <a class="reference internal" href="#odps-pre-case-tunnel"><em>快速开始</em></a> ；</li>
<li>对于SDK的更多介绍请参考 <a class="reference internal" href="odps_sdk/sdk.html#odps-sdk"><em>ODPS SDK介绍</em></a> ；</li>
</ul>
</div>
<div class="section" id="use-project">
<span id="odps-common-use-project"></span><h3>Use Project<a class="headerlink" href="#use-project" title="Permalink to this headline">¶</a></h3>
<p>命令格式:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">use</span> <span class="o">&lt;</span><span class="n">project_name</span><span class="o">&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>行为：</dt>
<dd><ul class="first last simple">
<li>进入指定项目空间。进入该空间后可以直接操作该项目空间下的所有对象。</li>
<li>项目空间不存在或当前用户不在此项目空间中，异常返回；</li>
</ul>
</dd>
</dl>
<p>示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="n">use</span> <span class="n">my_project</span>   <span class="c1">--my_project是用户有权限访问的一个project</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">上面给出的是在客户端中运行此命令的示例。所有的ODPS命令关键字、项目空间名、表名、列名大小写不敏感。</p>
</div>
<p>在命令运行后，用户可以直接访问该项目空间下的对象。例如，假设my_project项目空间下有表test_src，用户运行：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="k">sql</span>                              <span class="c1">-- 进入SQL命令空间，只有在此空间下才能够直接运行SQL命令</span>
<span class="n">odps</span><span class="p">:</span><span class="k">sql</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">test_src</span><span class="p">;</span>
</pre></div>
</div>
<p>ODPS会自动搜索项目空间my_project下的表。如果存在此表，返回表中的数据，如果此表不存在，异常退出。如果用户在my_project下想要访问另一项目空间my_project2下的表test_src，则需要指定项目空间名：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="k">sql</span>    <span class="c1">--进入客户端的sql shell，只有在这个shell下才能运行SQL语句</span>
<span class="n">odps</span><span class="p">:</span><span class="k">sql</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">my_project2</span><span class="p">.</span><span class="n">test_src</span><span class="p">;</span>
</pre></div>
</div>
<p>此时返回my_project2项目空间下的数据结果，而不是my_project下的test_src表数据。</p>
<p>ODPS没有提供创建及删除项目空间的命令。用户可以通过管理控制台达对各自的项目空间完成更多的配置及操作。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ODPS的不同功能命令，如：SQL及安全命令，需要在各自的命令空间下才能直接运行。详情请参考客户端文档 <a class="reference internal" href="odps_tools/odps_cli.html#odps-console"><em>ODPS客户端参考手册</em></a> 的介绍。</p>
</div>
</div>
<div class="section" id="create">
<h3>Create操作<a class="headerlink" href="#create" title="Permalink to this headline">¶</a></h3>
<p>ODPS客户端提供了Create命令来创建对象。</p>
<p>命令格式及帮助信息：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span> <span class="n">help</span> <span class="k">create</span>

<span class="k">Usage</span><span class="p">:</span> <span class="k">create</span> <span class="p">[</span><span class="n">OBJECT_TYPE</span><span class="p">]</span> <span class="p">[</span><span class="k">OPTIONS</span><span class="p">]</span> <span class="p">[</span><span class="n">ARGS</span><span class="p">]</span>
              <span class="n">OBJECT_TYPE</span> <span class="n">includes</span><span class="p">:</span> <span class="n">resource</span> <span class="k">and</span> <span class="k">function</span>

<span class="k">Global</span> <span class="k">options</span><span class="p">:</span>
    <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="c1">--project [PROJECT]                  Specify PROJECT</span>
    <span class="o">-</span><span class="k">c</span><span class="p">,</span> <span class="c1">--comment &lt;COMMENTS&gt;                 Specify comment messages</span>

<span class="k">Option</span> <span class="k">for</span> <span class="n">resource</span><span class="p">:</span>
    <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="c1">--force                              Force to create resource whether exist or not</span>

<span class="n">Available</span> <span class="n">OBJECT_TYPE</span><span class="p">:</span>

    <span class="n">resource</span> <span class="n">jar</span> <span class="o">&lt;</span><span class="n">LOCAL_JAR_FILE</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">RESOURCE_NAME</span><span class="p">]</span>
    <span class="n">resource</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">LOCAL_FILE</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">RESOURCE_NAME</span><span class="p">]</span>
    <span class="n">resource</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">TABLE_NAME</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">RESOURCE_NAME</span><span class="p">]</span>

    <span class="k">function</span> <span class="o">&lt;</span><span class="n">NAME</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="k">CLASS</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">RESOURCES</span><span class="o">&gt;</span>

<span class="n">Examples</span><span class="p">:</span>

    <span class="k">Create</span> <span class="n">resource</span><span class="p">:</span>
        <span class="k">create</span> <span class="n">resource</span> <span class="n">jar</span> <span class="n">local_jar_path</span><span class="o">/</span><span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>
        <span class="k">create</span> <span class="n">resource</span> <span class="o">-</span><span class="n">f</span> <span class="n">jar</span> <span class="n">local_jar_path</span><span class="o">/</span><span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>
        <span class="k">create</span> <span class="n">resource</span> <span class="n">jar</span> <span class="n">local_jar_path</span><span class="o">/</span><span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span> <span class="n">my_jar_named</span><span class="p">.</span><span class="n">jar</span>
        <span class="k">create</span> <span class="n">resource</span> <span class="k">table</span> <span class="n">my_project2</span><span class="p">.</span><span class="n">my_table_2</span>
        <span class="k">create</span> <span class="n">resource</span> <span class="k">table</span> <span class="n">my_part_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="n">my_part_res</span>
        <span class="k">create</span> <span class="n">resource</span> <span class="n">file</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">local_file_path</span><span class="o">/</span><span class="n">my_file</span><span class="p">.</span><span class="n">txt</span> <span class="n">my_file_name</span>

    <span class="k">Create</span> <span class="k">function</span><span class="p">:</span>
        <span class="k">create</span> <span class="k">function</span> <span class="n">my_func</span> <span class="n">com</span><span class="p">.</span><span class="n">aliyun</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">Func</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span><span class="p">:</span><span class="n">my_jar2</span><span class="p">.</span><span class="n">jar</span>
        <span class="k">create</span> <span class="k">function</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_func</span> <span class="n">com</span><span class="p">.</span><span class="n">aliyun</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">Func</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span><span class="p">:</span><span class="n">my_jar2</span><span class="p">.</span><span class="n">jar</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>OBJECT_TYPE：Create命令仅支持 <a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> 及 <a class="reference internal" href="#odps-common-function"><em>自定义函数(UDF)</em></a> 的创建，不支持 <a class="reference internal" href="#odps-common-project"><em>项目空间(Project)</em></a> 及 <a class="reference internal" href="#odps-common-table"><em>表(Table)</em></a> 的创建。如果想创建表，请参考 <a class="reference internal" href="odps_sql/odps_sql_grmr.html#odps-sql-create-table"><em>创建表(CREATE TABLE)</em></a> 。ODPS在客户端及SDK中不提供创建项目空间的操作；</li>
<li>OPTIONS：-p及-c选项对 <a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> 及 <a class="reference internal" href="#odps-common-function"><em>自定义函数(UDF)</em></a> 两种对象均有效，分别指定创建对象所属的项目空间及对该对象的描述信息。而-f选项仅对资源创建有效，若指定此选项，若存在同名资源，则覆盖原有的资源信息。</li>
</ul>
</dd>
</dl>
<div class="section" id="odps-common-add-resource-cmd">
<span id="id3"></span><h4>创建资源<a class="headerlink" href="#odps-common-add-resource-cmd" title="Permalink to this headline">¶</a></h4>
<p>命令格式：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">create</span> <span class="n">resource</span> <span class="n">jar</span> <span class="o">&lt;</span><span class="n">LOCAL_JAR_FILE</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">RESOURCE_NAME</span><span class="p">]</span>
<span class="k">create</span> <span class="n">resource</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">LOCAL_FILE</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">RESOURCE_NAME</span><span class="p">]</span>
<span class="k">create</span> <span class="n">resource</span> <span class="k">table</span> <span class="o">&lt;</span><span class="k">TABLE_NAME</span><span class="p">[(</span><span class="n">PARTITION_SPEC</span><span class="p">)]</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">RESOURCE_NAME</span><span class="p">]</span>

<span class="k">Option</span> <span class="k">for</span> <span class="n">resource</span><span class="p">:</span>
    <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="c1">--force                              Force to create resource whether exist or not</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>TYPE：资源类型。ODPS目前仅支持JAR、FILE及TABLE三种类型的资源。资源类型的介绍请参考 <a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> ；</li>
<li>LOCAL_JAR_FILE|LOCAL_FILE：本地文件所在路径；</li>
<li>TABLE_NAME：ODPS中的表名；</li>
<li>[(PARTITION_SPEC)]：当添加的资源为分区表时，ODPS仅支持将某个分区作为资源，不支持将整张分区表作为资源。(PARTITION_SPEC)参数形式如：(pt=&#8216;3&#8217;,ds=&#8216;3&#8217;)，其中pt及ds表示分区列；</li>
<li>RESOURCE_NAME：资源名，资源在ODPS中的唯一标识。若不指定RESOURCE_NAME，以文件名作为资源名；</li>
<li>-f：如果已经存在同名的资源，可以使用-f选项将其覆盖；</li>
</ul>
</dd>
</dl>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">create</span> <span class="n">resource</span> <span class="n">jar</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>
<span class="k">create</span> <span class="n">resource</span> <span class="n">jar</span> <span class="o">-</span><span class="n">f</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>
<span class="k">create</span> <span class="n">resource</span> <span class="n">jar</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span> <span class="n">my_jar_named</span><span class="p">.</span><span class="n">jar</span>
<span class="k">create</span> <span class="n">resource</span> <span class="k">table</span> <span class="n">my_project2</span><span class="p">.</span><span class="n">my_table_2</span>
<span class="k">create</span> <span class="n">resource</span> <span class="k">table</span> <span class="n">my_part_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span> <span class="n">my_part_res</span>
<span class="k">create</span> <span class="n">resource</span> <span class="n">file</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_file</span><span class="p">.</span><span class="n">txt</span> <span class="n">my_file_name</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">目前，每个资源文件的大小不能超过64M，单个SQL或MapReduce任务所引用的资源总大小不能超过512M。</p>
</div>
</div>
<div class="section" id="odps-common-create-func">
<span id="id4"></span><h4>创建函数<a class="headerlink" href="#odps-common-create-func" title="Permalink to this headline">¶</a></h4>
<p>命令格式：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">create</span> <span class="k">function</span> <span class="o">&lt;</span><span class="n">NAME</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="k">CLASS</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">RESOURCES</span><span class="o">&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>NAME：UDF函数名，这个名字就是SQL中引用该函数所使用的名字。</li>
<li>CLASS：这个参数就是从Java顶层包名一直到实现UDF类名的有效名称。</li>
<li>RESOURCES：UDF所用到的资源列表，这个里面必须包括UDF代码所在的资源。如果用户UDF中需要读取其他资源文件，这个列表中还得包括UDF所读取的资源文件列表。资源列表由多个资源名组成，资源名之间由冒号&#8221;:&#8221;分隔。</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>同名函数只能注册一次。</li>
<li>一般情况下用户自建函数无法覆盖同名的 <a class="reference internal" href="odps_sql/odps_sql_func.html#odps-sql-function"><em>SQL内建函数</em></a> 。只有项目空间的Owner才有权利覆盖内建函数。</li>
</ul>
</div>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">create</span> <span class="k">function</span> <span class="n">my_func</span> <span class="n">com</span><span class="p">.</span><span class="n">aliyun</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">Func</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span><span class="p">:</span><span class="n">my_jar2</span><span class="p">.</span><span class="n">jar</span>
<span class="k">create</span> <span class="k">function</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_func</span> <span class="n">com</span><span class="p">.</span><span class="n">aliyun</span><span class="p">.</span><span class="n">demo</span><span class="p">.</span><span class="n">Func</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span><span class="p">:</span><span class="n">my_jar2</span><span class="p">.</span><span class="n">jar</span>
</pre></div>
</div>
<p>假设Java UDF类org.alidata.odps.udf.examples.Lower在my_lower.jar中，创建函数my_lower：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">create</span> <span class="k">function</span> <span class="n">test_lower</span> <span class="n">org</span><span class="p">.</span><span class="n">alidata</span><span class="p">.</span><span class="n">odps</span><span class="p">.</span><span class="n">udf</span><span class="p">.</span><span class="n">examples</span><span class="p">.</span><span class="k">Lower</span> <span class="n">my_lower</span><span class="p">.</span><span class="n">jar</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="delete">
<span id="odps-common-del-cmd"></span><h3>Delete操作<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h3>
<p>用来删除项目空间中的对象。</p>
<p>命令格式及帮助信息：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span> <span class="n">help</span> <span class="n">del</span>
<span class="k">Usage</span><span class="p">:</span> <span class="n">del</span> <span class="p">[</span><span class="n">OBJECT_TYPE</span><span class="p">]</span> <span class="p">[</span><span class="k">OPTION</span><span class="p">]</span> <span class="p">[</span><span class="n">ARGS</span><span class="p">]</span>
              <span class="n">OBJECT_TYPE</span> <span class="n">includes</span><span class="p">:</span> <span class="n">resource</span> <span class="k">and</span> <span class="k">function</span>

<span class="k">OPTION</span><span class="p">:</span>
    <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="c1">--project [PROJECT]                  Specify PROJECT</span>

<span class="n">Available</span> <span class="n">OBJECT_TYPE</span><span class="p">:</span>

    <span class="n">resource</span> <span class="o">&lt;</span><span class="n">RESOURCE_NAME</span><span class="o">&gt;</span>

    <span class="k">function</span> <span class="o">&lt;</span><span class="n">FUNCTION_NAME</span><span class="o">&gt;</span>

<span class="n">Examples</span><span class="p">:</span>

    <span class="k">Delete</span> <span class="n">resource</span><span class="p">:</span>
        <span class="n">del</span> <span class="n">resource</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>
        <span class="n">del</span> <span class="n">resource</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>

    <span class="k">Delete</span> <span class="k">function</span><span class="p">:</span>
        <span class="n">del</span> <span class="k">function</span> <span class="n">my_func</span>
        <span class="n">del</span> <span class="k">function</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_func</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>OBJECT_TYPE：Del命令仅支持 <a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> 及 <a class="reference internal" href="#odps-common-function"><em>自定义函数(UDF)</em></a> 的删除，不支持 <a class="reference internal" href="#odps-common-project"><em>项目空间(Project)</em></a> 及 <a class="reference internal" href="#odps-common-table"><em>表(Table)</em></a> 的删除操作。如果想删除表，请参考 <a class="reference internal" href="odps_sql/odps_sql_grmr.html#odps-sql-drop-table"><em>删除表(DROP TABLE)</em></a> 。ODPS在客户端及SDK中不提供删除项目空间的操作；</li>
<li>OPTION：-p选项对资源、函数两种对象均有效，用于指定删除对象所属的项目空间。</li>
</ul>
</dd>
</dl>
<div class="section" id="odps-common-del-resource-cmd">
<span id="id5"></span><h4>删除资源<a class="headerlink" href="#odps-common-del-resource-cmd" title="Permalink to this headline">¶</a></h4>
<p>命令格式：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">del</span> <span class="n">resource</span> <span class="o">&lt;</span><span class="n">RESOURCE_NAME</span><span class="o">&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>RESOURCE_NAME：资源名</li>
</ul>
</dd>
</dl>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">del</span> <span class="n">resource</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>
<span class="n">del</span> <span class="n">resource</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_jar</span><span class="p">.</span><span class="n">jar</span>
</pre></div>
</div>
</div>
<div class="section" id="odps-common-del-func">
<span id="id6"></span><h4>删除函数<a class="headerlink" href="#odps-common-del-func" title="Permalink to this headline">¶</a></h4>
<p>命令格式：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">del</span> <span class="k">function</span> <span class="o">&lt;</span><span class="n">FUNCTION_NAME</span><span class="o">&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>FUNCTION_NAME：函数名</li>
</ul>
</dd>
</dl>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">del</span> <span class="k">function</span> <span class="n">my_func</span>
<span class="n">del</span> <span class="k">function</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_func</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="list">
<h3>List操作<a class="headerlink" href="#list" title="Permalink to this headline">¶</a></h3>
<p>命令格式及帮助信息：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">Usage</span><span class="p">:</span> <span class="n">ls</span> <span class="o">&lt;</span><span class="n">OBJECTS_TYPE</span><span class="o">&gt;</span> <span class="p">[</span><span class="k">OPTIONS</span><span class="p">]</span> <span class="p">[</span><span class="n">ARGS</span><span class="p">]</span>
          <span class="n">OBJECTS_TYPE</span> <span class="n">includes</span><span class="p">:</span> <span class="n">tables</span><span class="p">,</span> <span class="n">partitions</span><span class="p">,</span> <span class="n">resources</span><span class="p">,</span> <span class="n">functions</span> <span class="k">and</span> <span class="n">instances</span>

<span class="k">Global</span> <span class="k">option</span><span class="p">:</span>
    <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="c1">--project [PROJECT]                  List objects in the specified PROJECT</span>

<span class="k">Options</span> <span class="k">for</span> <span class="n">instances</span><span class="p">:</span>
    <span class="c1">--start=&lt;START_TIME&gt;                     yyyyMMddHHmm</span>
    <span class="c1">--end=&lt;END_TIME&gt;                         yyyyMMddHHmm</span>
    <span class="c1">--limit=&lt;NUM&gt;</span>

<span class="k">Option</span> <span class="k">for</span> <span class="n">tables</span><span class="p">:</span>
    <span class="c1">--prefix &lt;NAME_PREFIX&gt;                   Specify a name prefix for filtering objects</span>

<span class="n">Examples</span><span class="p">:</span>

    <span class="n">List</span> <span class="n">tables</span><span class="p">:</span>
        <span class="n">ls</span> <span class="n">tables</span>
        <span class="n">ls</span> <span class="n">tables</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>
        <span class="n">ls</span> <span class="n">tables</span> <span class="c1">--prefix my_table_prefix</span>

    <span class="n">List</span> <span class="n">partitions</span><span class="p">:</span>
        <span class="n">ls</span> <span class="n">partitions</span> <span class="n">my_table</span>
        <span class="n">ls</span> <span class="n">partitions</span> <span class="n">my_project</span><span class="p">.</span><span class="n">my_table</span>
        <span class="n">ls</span> <span class="n">partitions</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_table</span>
        <span class="n">ls</span> <span class="n">partitions</span> <span class="n">my_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="s1">&#39;03&#39;</span><span class="p">)</span>

    <span class="n">List</span> <span class="n">resources</span><span class="p">:</span>
        <span class="n">ls</span> <span class="n">resources</span>
        <span class="n">ls</span> <span class="n">resources</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>

    <span class="n">List</span> <span class="n">functions</span><span class="p">:</span>
        <span class="n">ls</span> <span class="n">functions</span>
        <span class="n">ls</span> <span class="n">functions</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>

    <span class="n">List</span> <span class="n">instances</span><span class="p">:</span>
        <span class="n">ls</span> <span class="n">instances</span>
        <span class="n">ls</span> <span class="n">instances</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>
        <span class="n">ls</span> <span class="n">instances</span> <span class="c1">--start=201403050000 --end=201403050000</span>
        <span class="n">ls</span> <span class="n">instances</span> <span class="c1">--limit 100</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>支持的OBJECTS_TYPE包括：表(tables)、资源(resources)、函数(functions)及实例(instances)；</li>
<li>-p选项用来指定所要查看的项目空间，若不指定，则查看当前项目空间内的对象；</li>
</ul>
</dd>
</dl>
<div class="section" id="id7">
<h4>查看表清单<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">ls</span> <span class="n">tables</span>                             <span class="c1">--查看当前项目空间中的所有表</span>
<span class="n">ls</span> <span class="n">tables</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>               <span class="c1">--查看指定项目空间my_project下的所有表</span>
<span class="n">ls</span> <span class="n">tables</span> <span class="c1">--prefix my_table_prefix    --查看以my_table_prefix为前缀的表</span>
</pre></div>
</div>
<dl class="docutils">
<dt>说明：</dt>
<dd><ul class="first last simple">
<li>&#8211;prefix选项，指定所要查看的表的前缀，不符合此要求的表名将被过滤；</li>
</ul>
</dd>
</dl>
<p>客户端输出示例：</p>
<div class="highlight-sql"><pre>odps:my_project&gt; list tables
Name                                    Owner
-------------------------------------------------------------------------------
my_table                                ALIYUN$test_user@aliyun.com
my_table2                               ALIYUN$test_user@aliyun.com
....</pre>
</div>
<dl class="docutils">
<dt>显示的内容包包括：</dt>
<dd><ul class="first last simple">
<li>Name：资源名称；</li>
<li>Owner：表的创建者；</li>
<li>ALIYUN是系统提示符，表示用户是阿里云用户;</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="odps-common-list-resource-cmd">
<span id="id8"></span><h4>查看资源清单<a class="headerlink" href="#odps-common-list-resource-cmd" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">ls</span> <span class="n">resources</span>                  <span class="c1">--查看当前项目空间中的所有的资源</span>
<span class="n">ls</span> <span class="n">resources</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>    <span class="c1">--查看指定项目空间my_project下的所有资源</span>
</pre></div>
</div>
<p>客户端输出示例：</p>
<div class="highlight-sql"><pre>odps:my_project&gt; list resources
Name               Owner                          Type      Comment
---------------------------------------------------------------------
my_jar.jar         ALIYUN$user_test@aliyun.com    JAR
my_table_2         ALIYUN$user_test@aliyun.com    TABLE
my_file_name       ALIYUN$user_test@aliyun.com    FILE
...</pre>
</div>
<dl class="docutils">
<dt>显示的内容包括：</dt>
<dd><ul class="first last simple">
<li>Name：资源名称；</li>
<li>Owner：资源的创建者；</li>
<li>Type：资源类型，相关介绍请参考 <a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> ；</li>
<li>Comment：创建资源时指定的对该资源的描述信息；</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="odps-common-ls-func">
<span id="id9"></span><h4>查看函数清单<a class="headerlink" href="#odps-common-ls-func" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">ls</span> <span class="n">functions</span>                  <span class="c1">--查看当前项目空间中的所有的自定义函数</span>
<span class="n">ls</span> <span class="n">functions</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>    <span class="c1">--查看指定项目空间my_project下的所有自定义函数</span>
</pre></div>
</div>
<p>客户端输出示例：</p>
<div class="highlight-sql"><pre>odps:my_project&gt; list functions
Name         Owner                          ClassType &amp; Resources
--------------------------------------------------------------------------------------------------------------------
test_lower   ALIYUN$test_user@aliyun.com    org.alidata.odps.udf.examples.Lower [my_project/resources/my_lower.jar]
....</pre>
</div>
<dl class="docutils">
<dt>显示的内容包括：</dt>
<dd><ul class="first last simple">
<li>Name：资源名称；</li>
<li>Owner：资源的创建者；</li>
<li>ClassType &amp; Resources：创建函数时指定的类名及资源名称；</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id10">
<h4>查看实例清单<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">ls</span> <span class="n">instances</span>                                          <span class="c1">--查看当前项目空间中的当天的实例信息</span>
<span class="n">ls</span> <span class="n">instances</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span>                            <span class="c1">--查看指定项目空间my_project下，当天的实例信息</span>
<span class="n">ls</span> <span class="n">instances</span> <span class="c1">--start=201403050000 --end=201403090000  --查看从2014年3月5日到2014年3月9日的实例信息</span>
<span class="n">ls</span> <span class="n">instances</span> <span class="c1">--limit 100                              --查看按时间排序，最后100个实例信息</span>
</pre></div>
</div>
<p>客户端输出示例：</p>
<p>查看从2014年3月30日0点0分到2014年3月30日14点0分，按时间排序，最近5个实例信息。</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">odps_test_mrtask</span><span class="o">&gt;</span> <span class="n">ls</span> <span class="n">instances</span> <span class="c1">--limit 5 --start=201403300000 --end=201403301400</span>
<span class="n">InstanceId</span>                  <span class="n">Elapsed</span>   <span class="n">Status</span>        <span class="n">StartTime</span>           <span class="n">EndTime</span>
<span class="c1">--------------------------------------------------------------------------------------------</span>
<span class="mi">20140329220801554</span><span class="n">g7go02ma</span>   <span class="mi">0</span><span class="n">s</span>        <span class="n">Terminated</span>    <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">01</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">01</span>
<span class="mi">20140329220801750</span><span class="n">g8go02ma</span>   <span class="mi">1</span><span class="n">s</span>        <span class="n">Terminated</span>    <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">01</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">02</span>
<span class="mi">20140329220801779</span><span class="n">g9go02ma</span>   <span class="mi">1</span><span class="n">s</span>        <span class="n">Terminated</span>    <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">01</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">02</span>
<span class="mi">2014032922080218</span><span class="n">ghbj12ma</span>    <span class="mi">0</span><span class="n">s</span>        <span class="n">Terminated</span>    <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">02</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">02</span>
<span class="mi">20140329220802245</span><span class="n">gago02ma</span>   <span class="mi">0</span><span class="n">s</span>        <span class="n">Terminated</span>    <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">02</span> <span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">06</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">02</span>

<span class="n">Total</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span><span class="mi">2014</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">30</span> <span class="mi">14</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">],</span> <span class="k">limit</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
<dl class="docutils">
<dt>显示的内容包括：</dt>
<dd><ul class="first last simple">
<li>InstanceId：实例ID，每个实例的唯一标识；</li>
<li>Elapsed：每个实例的消耗时间；</li>
<li>Status：实例的状态，详情请参考 <a class="reference internal" href="#odps-common-instance"><em>实例(Instance)</em></a> ；</li>
<li>StartTime：实例开始运行的时间，如果不指定仅能查看当天的实例信息；</li>
<li>EndTime：实例结束时间；</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="describe">
<h3>Describe操作<a class="headerlink" href="#describe" title="Permalink to this headline">¶</a></h3>
<p>ODPS客户端提供Desc命令帮助用户查看对象信息</p>
<p>命令格式及帮助信息：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span> <span class="n">help</span> <span class="k">desc</span>
<span class="k">Usage</span><span class="p">:</span> <span class="k">desc</span> <span class="p">[</span><span class="n">OBJECT_TYPE</span><span class="p">]</span> <span class="p">[</span><span class="k">OPTION</span><span class="p">]</span> <span class="p">[</span><span class="n">ARGS</span><span class="p">]</span>
        <span class="n">OBJECT_TYPE</span> <span class="n">includes</span><span class="p">:</span> <span class="n">project</span><span class="p">,</span> <span class="k">table</span><span class="p">,</span> <span class="n">partition</span> <span class="k">and</span> <span class="n">resource</span>

<span class="k">OPTION</span><span class="p">:</span>
    <span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="c1">--project [PROJECT]                  Specify PROJECT</span>


<span class="n">Examples</span><span class="p">:</span>

    <span class="k">Describe</span> <span class="n">project</span><span class="p">:</span>
        <span class="k">desc</span> <span class="n">project</span> <span class="n">my_project</span>

    <span class="k">Describe</span> <span class="k">table</span><span class="p">:</span>
        <span class="k">desc</span> <span class="k">table</span> <span class="n">my_table</span>
        <span class="k">desc</span> <span class="k">table</span> <span class="n">my_project</span><span class="p">.</span><span class="n">my_table</span>

    <span class="k">Describe</span> <span class="n">partition</span><span class="p">:</span>
        <span class="k">desc</span> <span class="k">table</span> <span class="n">my_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="s1">&#39;03&#39;</span><span class="p">)</span>
        <span class="k">desc</span> <span class="k">table</span> <span class="n">my_project</span><span class="p">.</span><span class="n">my_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="s1">&#39;03&#39;</span><span class="p">)</span>
        <span class="k">desc</span> <span class="k">table</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="s1">&#39;03&#39;</span><span class="p">)</span>

    <span class="k">Describe</span> <span class="n">resource</span><span class="p">:</span>
        <span class="k">desc</span> <span class="n">resource</span> <span class="n">my_resource</span>
        <span class="k">desc</span> <span class="n">resource</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_resource</span>
</pre></div>
</div>
<p>说明：</p>
<ul class="simple">
<li>OBJECT_TYPE：指明需要查看的ODPS对象的类型。此命令仅支持 <a class="reference internal" href="#odps-common-project"><em>项目空间(Project)</em></a> 、<a class="reference internal" href="#odps-common-table"><em>表(Table)</em></a> 、<a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> 及 <a class="reference internal" href="#odps-common-function"><em>自定义函数(UDF)</em></a> 类型的对象；</li>
<li>OPTIONS：目前仅支持-p选项，指定查看某个项目空间下的对象信息；</li>
</ul>
<div class="section" id="id11">
<h4>查看项目空间信息<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">desc</span> <span class="n">project</span> <span class="n">my_project</span>
</pre></div>
</div>
<p>运行结果：</p>
<div class="highlight-sql"><pre>odps:my_project&gt; desc project my_project
Name                                    my_project
Description                             project for test
Owner                                   ALIYUN$test_user@aliyun.com
CreatedTime                             Wed Jun 26 17:01:35 CST 2013

Properties:
WHITE_LIST                              []


Security:
Protected                               false
CheckPermissionUsingACL                 true
CheckPermissionUsingPolicy              true
LabelSecurity                           false
ObjectCreatorHasAccessPermission        true
ObjectCreatorHasGrantPermission         true</pre>
</div>
<p>此时OBJECT_TYPE为project，意味着Describe命令描述的对象my_project是项目空间。当OBJECT_TYPE为project时，-p选项依然有效，只是二者不能有冲突，否则报错，例如：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span> <span class="k">desc</span> <span class="n">project</span> <span class="n">my_project</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project2</span>
<span class="n">ERROR</span><span class="p">:</span> <span class="n">Conflicting</span> <span class="n">argument</span><span class="p">.</span>
</pre></div>
</div>
</div>
<div class="section" id="odps-common-desc-table-cmd">
<span id="id12"></span><h4>查看表信息<a class="headerlink" href="#odps-common-desc-table-cmd" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">desc</span> <span class="k">table</span> <span class="n">my_table</span>
<span class="k">desc</span> <span class="k">table</span> <span class="n">my_project</span><span class="p">.</span><span class="n">my_table</span>
<span class="k">desc</span> <span class="k">table</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_table</span>
</pre></div>
</div>
<p>输出示例：</p>
<div class="highlight-sql"><pre>odps:my_project&gt; desc table sale_detail

+------------------------------------------------------------------------------------+
| Table: sale_detail                                                                 |
| Owner: ALIYUN$test_user@aliyun.com | Project: my_project                           |
| TableComment:                                                                      |
+------------------------------------------------------------------------------------+
| CreateTime:               2014-01-21 04:06:38                                      |
| LastMetaModifiedTime:     2014-01-21 04:06:38                                      |
| LastDataModifiedTime:     2014-01-21 04:13:08                                      |
+------------------------------------------------------------------------------------+
| Type: Table                  | Size: 0                                             |
+------------------------------------------------------------------------------------+
| Native Columns:                                                                    |
+------------------------------------------------------------------------------------+
| Field           | Type       | Comment                                             |
+------------------------------------------------------------------------------------+
| shop_name       | string     |                                                     |
| customer_id     | string     |                                                     |
| total_price     | double     |                                                     |
+------------------------------------------------------------------------------------+
| Partition Columns:                                                                 |
+------------------------------------------------------------------------------------+
| sale_date       | string     |                                                     |
| region          | string     |                                                     |
+------------------------------------------------------------------------------------+</pre>
</div>
<p>输出信息包括：Table(表的名称)、Owner(表的创建者)、Project(表所属的项目空间)、TableComment(表的描述信息)、CreateTime(创建时间)、LastMetaModifiedTime(表的原信息最后一次被修改的时间)、LastDataModifiedTime(表中的数据最后一次被改动的时间)、Type(表的类型，Table或View)、Size(表数据所占存储容量的大小，单位Byte)、Native Columns(非分区列的信息，包括：列名，类型，备注)及Partition Columns(分区列信息，包括：分区名，类型，备注)。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>如果是不带分区的表，将不会显示Partition Columns相关信息；</li>
<li>如果描述的是一个视图(View)，将不显示Size选项，而是ViewText选项，表示View的定义，例如：select * from src。关于视图的介绍请参考 <a class="reference internal" href="odps_sql/odps_sql_grmr.html#odps-sql-create-view"><em>创建视图(CREATE VIEW)</em></a> ；</li>
</ul>
</div>
</div>
<div class="section" id="odps-common-desc-partition-cmd">
<span id="id13"></span><h4>查看表分区信息<a class="headerlink" href="#odps-common-desc-partition-cmd" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">desc</span> <span class="k">table</span> <span class="n">my_part_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="s1">&#39;03&#39;</span><span class="p">)</span>
<span class="k">desc</span> <span class="k">table</span> <span class="n">my_project</span><span class="p">.</span><span class="n">my_part_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="s1">&#39;03&#39;</span><span class="p">)</span>
<span class="k">desc</span> <span class="k">table</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_table</span><span class="p">(</span><span class="n">pt</span><span class="o">=</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="s1">&#39;03&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="odps-common-desc-resource-cmd">
<span id="id14"></span><h4>查看资源信息<a class="headerlink" href="#odps-common-desc-resource-cmd" title="Permalink to this headline">¶</a></h4>
<p>命令示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">desc</span> <span class="n">resource</span> <span class="n">my_resource</span>
<span class="k">desc</span> <span class="n">resource</span> <span class="o">-</span><span class="n">p</span> <span class="n">my_project</span> <span class="n">my_resource</span>
</pre></div>
</div>
<p>客户端输出示例：</p>
<div class="highlight-sql"><pre>odps:my_project&gt; desc resource my_jar.jar
Name                                    my_jar.jar
Owner                                   ALIYUN$test_user@aliyun.com
Type                                    JAR
Comment
CreatedTime                             Mon Sep 16 12:10:54 CST 2013
LastModifiedTime                        Sun Mar 30 06:08:26 CST 2014</pre>
</div>
<dl class="docutils">
<dt>显示项说明：</dt>
<dd><ul class="first last simple">
<li>Name：资源名；</li>
<li>Owner：资源创建者；</li>
<li>Type：资源类型，详情请参考 <a class="reference internal" href="#odps-common-resource"><em>资源(Resource)</em></a> ；</li>
<li>Comment：资源描述；</li>
<li>CreatedTime：被创建的时间；</li>
<li>LastModifiedTime：最近一次被修改的时间，即最近一次使用被重新覆盖的时间，相关命令请参考 <a class="reference internal" href="#odps-common-add-resource-cmd"><em>创建资源</em></a> ；</li>
</ul>
</dd>
</dl>
</div>
</div>
<div class="section" id="id15">
<h3>其他实例相关操作<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<div class="section" id="status-instance">
<span id="odps-common-status-ins"></span><h4>Status Instance<a class="headerlink" href="#status-instance" title="Permalink to this headline">¶</a></h4>
<p>命令格式：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">status</span> <span class="o">&lt;</span><span class="n">instance_id</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>描述：</dt>
<dd><ul class="first last simple">
<li>instance_id: 实例的唯一标识符。指定查询哪个实例状态。</li>
</ul>
</dd>
</dl>
<p>示例：</p>
<div class="highlight-sql"><pre>odps:my_project&gt; status 20140327234656595ggdz8k4y2
InstanceID           20140327234656595ggdz8k4y2
Owner                ALIYUN$user_test@aliyun.com
StartTime            Fri Mar 28 07:46:55 CST 2014
EndTime              Fri Mar 28 07:47:32 CST 2014
Status               SUCCESS</pre>
</div>
<p>查看ID为20140327234656595ggdz8k4y2的实例的状态，查询结果为Success。</p>
<dl class="docutils">
<dt>输出项说明：</dt>
<dd><ul class="first last simple">
<li>返回指定实例的ID(InstanceID)，创建者(Owner)，开始时间(StartTime)，结束时间(EndTime)，状态(Status)。</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="kill-instance">
<span id="odps-common-kill-ins"></span><h4>Kill Instance<a class="headerlink" href="#kill-instance" title="Permalink to this headline">¶</a></h4>
<p>命令格式:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">kill</span> <span class="o">&lt;</span><span class="n">instance_id</span><span class="o">&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>行为：</dt>
<dd><ul class="first last simple">
<li>停止用户指定的实例，此实例的状态必须为Running；</li>
</ul>
</dd>
<dt>参数：</dt>
<dd><ul class="first last simple">
<li>instance_id：实例的唯一标识符。必须是状态为Running的实例的ID，否则抛异常；</li>
</ul>
</dd>
</dl>
<p>示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="n">kill</span> <span class="mi">20131225123302267</span><span class="n">gk3u6k4y2</span><span class="p">;</span>
</pre></div>
</div>
<p>停止ID为20131225123302267gk3u6k4y2的实例。</p>
</div>
<div class="section" id="attach-instance">
<h4>Attach Instance<a class="headerlink" href="#attach-instance" title="Permalink to this headline">¶</a></h4>
<p>命令格式:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">attach</span> <span class="o">&lt;</span><span class="n">instance_id</span><span class="o">&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt>行为：</dt>
<dd><ul class="first last simple">
<li>查看正在运行的实例的当前详细运行信息。</li>
</ul>
</dd>
<dt>参数：</dt>
<dd><ul class="first last simple">
<li>instance_id：实例的唯一标识符。必须是状态为Running的实例的ID，否则无任何输出信息；</li>
</ul>
</dd>
</dl>
<p>示例：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="n">attach</span> <span class="mi">20131225123302267</span><span class="n">gk3u6k4y2</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="log">
<span id="odps-pre-log"></span><h3>Log<a class="headerlink" href="#log" title="Permalink to this headline">¶</a></h3>
<p>ODPS的所有任务都是在分布式环境下运行的。通过Log命令，用户可以查看任务中每个进程(Worker)的状态，命令格式：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">log</span> <span class="o">&lt;</span><span class="n">action</span><span class="o">&gt;</span> <span class="p">[</span><span class="k">OPTIONS</span><span class="p">]</span>
</pre></div>
</div>
<p>其中action包括：get，help及list。每个action的功能可以通过help action查看，例如查看list action的功能：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="n">log</span> <span class="n">help</span> <span class="n">list</span><span class="p">;</span>
<span class="k">Usage</span><span class="p">:</span> <span class="n">log</span> <span class="n">list</span> <span class="p">[</span><span class="k">OPTIONS</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">INSTANCE_ID</span><span class="o">&gt;</span>
<span class="k">OPTIONS</span><span class="p">:</span>
<span class="o">-</span><span class="n">d</span><span class="p">,</span><span class="c1">--duration      sort by duration</span>
<span class="o">-</span><span class="n">F</span><span class="p">,</span><span class="c1">--failed        only print failed workers</span>
<span class="o">-</span><span class="n">l</span><span class="p">,</span><span class="c1">--limit &lt;arg&gt;   maximum printed worker number</span>
<span class="o">-</span><span class="n">r</span><span class="p">,</span><span class="c1">--reverse       reverse the sort order of results</span>
<span class="o">-</span><span class="n">R</span><span class="p">,</span><span class="c1">--running       only print running workers</span>
</pre></div>
</div>
<p>说明：</p>
<blockquote>
<div><ul class="simple">
<li>-d：依据执行SQL任务的每个进程的执行时间长短而排序；</li>
<li>-F：只显示失败的进程(Worker)；</li>
<li>-l：显示进程的最大数量；</li>
<li>-r：反向排序，目前必须与-d选项配合使用；</li>
<li>-R：只显示运行中的进程；</li>
</ul>
</div></blockquote>
<p>下面给出使用log命令的示例：</p>
<ol class="arabic simple">
<li>假设存在表，运行如下SQL：</li>
</ol>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">select</span> <span class="k">cast</span><span class="p">(</span><span class="n">sale_date</span> <span class="k">as</span> <span class="n">datetime</span><span class="p">)</span> <span class="k">from</span> <span class="n">sale_detail</span><span class="p">;</span>
   <span class="c1">-- 这是一个会在运行时报错的ODPS SQL，失败原因会在后续章节中涉及。</span>
   <span class="c1">-- 在这里，用户可以先不必关心失败的原因。</span>
</pre></div>
</div>
<p>得到如下格式输出：</p>
<div class="highlight-sql"><pre>odps:sql:my_project&gt;select cast(sale_date as datetime) from sale_detail;

ID = 20140116065603291go4musna
...
FAILED: ODPS-0121095:Invalid arguments - in function cast, string datetime's
 format must be yyyy-mm-dd hh:mi:ss,  input string is:201310,
 column hint is 'sale_detail.sale_date'</pre>
</div>
<ol class="arabic simple" start="2">
<li>查看这个SQL的每个进程的状态：</li>
</ol>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="n">log</span> <span class="n">list</span> <span class="mi">20140116065603291</span><span class="n">go4musna</span><span class="p">;</span>
<span class="n">M1_Stg1</span><span class="o">#</span><span class="mi">0</span><span class="n">_0</span>         <span class="mi">1970</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">08</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="mi">0</span><span class="n">s</span>         <span class="n">Failed</span>
</pre></div>
</div>
<p>如果您对SQL的分布式实现方式不够了解，可以忽略第一项&#8221;M1_Stg1#0_0&#8221;展示的意义，但请注意这个字段能够唯一标识SQL执行过程中的每个进程。这一项表示了ODPS SQL的执行逻辑，不在本章的介绍范围内。第二列表示每个进程启动的时间。第三项表示每个进程工作的时间(由于示例中处理的数据量很少，只有两行数据，因此执行时间不足1秒)。最后一列Failed表示进程的状态为失败。</p>
<ol class="arabic simple" start="3">
<li>查看进程的stdout和stderr：</li>
</ol>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">odps</span><span class="p">:</span><span class="n">my_project</span><span class="o">&gt;</span><span class="n">log</span> <span class="k">get</span> <span class="mi">20140116065603291</span><span class="n">go4musna</span> <span class="n">M1_Stg1</span><span class="o">#</span><span class="mi">0</span><span class="n">_0</span> <span class="o">-</span><span class="k">type</span> <span class="n">stderr</span><span class="p">;</span>
<span class="n">agrv</span> <span class="mi">0</span>  <span class="o">=</span> <span class="n">cgcreate</span>
<span class="n">agrv</span> <span class="mi">1</span>  <span class="o">=</span> <span class="o">-</span><span class="n">a</span>
<span class="n">agrv</span> <span class="mi">2</span>  <span class="o">=</span> <span class="k">admin</span>
<span class="n">agrv</span> <span class="mi">3</span>  <span class="o">=</span> <span class="o">-</span><span class="k">g</span>
<span class="n">agrv</span> <span class="mi">4</span>  <span class="o">=</span> <span class="n">memory</span>

<span class="n">odps</span><span class="o">@</span> <span class="n">odps_test_smode</span><span class="o">&gt;</span><span class="n">log</span> <span class="k">get</span> <span class="mi">20140116065603291</span><span class="n">go4musna</span> <span class="n">M1_Stg1</span><span class="o">#</span><span class="mi">0</span><span class="n">_0</span> <span class="o">-</span><span class="k">type</span> <span class="k">stdout</span><span class="p">;</span>
<span class="n">LimitKey</span><span class="p">:</span><span class="n">core</span>
<span class="n">SetLimit</span> <span class="o">-</span> <span class="n">core</span><span class="p">:</span><span class="n">unlimited</span>
<span class="p">[</span><span class="mi">2014</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">16</span> <span class="mi">14</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">45</span><span class="p">.</span><span class="mi">456484</span><span class="p">]</span> <span class="c1">---------- Run Task: M1_Stg1#0 ----------</span>
</pre></div>
</div>
<p>在这个示例中，从stdout和stderr处无法看到有帮助的出错信息。但在某些时候，stdout和stderr的信息可以帮助用户调查问题。我们建议有分布式经验的用户使用此功能。</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Log的功能十分强大，在示例中我们我们仅仅展示了最基础的使用场景。请用户可以通过log help获取更加详细的使用说明。</p>
</div>
</div>
</div>
<div class="section" id="odps-pre-case-tunnel">
<span id="id16"></span><h2>快速开始<a class="headerlink" href="#odps-pre-case-tunnel" title="Permalink to this headline">¶</a></h2>
<p>ODPS的各项功能都可以通过客户端来访问，以下是一个使用客户端运行ODPS处理数据的快速示例。</p>
<p>首先下载ODPS客户端，解压到一个文件夹中。由于客户端是用Java开发的，因此要确保机器上有JRE 1.6。在解压的文件夹中可以看到如下3个文件夹：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">bin</span><span class="o">/</span>  <span class="n">conf</span><span class="o">/</span>  <span class="n">lib</span><span class="o">/</span>
</pre></div>
</div>
<p>在conf文件夹中有odps.conf文件。编辑此文件，填写相关信息：</p>
<div class="highlight-sql"><pre>access.id=*******************
access.key=*********************
    #这两项是由云账号提供的，在阿里云官网上可以获取
default.project=my_project
    #指定您想进入的项目空间。此项可忽略，缺省时进入客户端后需要使用"use &lt;project_name&gt;"命令进入您的项目空间。
endpoint=http://service.odps.aliyun.com/api
    #odps公网服务地址</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">关于客户端的详细介绍请参考 <a class="reference internal" href="odps_tools/odps_cli.html#odps-console"><em>ODPS客户端参考手册</em></a> 。</p>
</div>
<p>修改好配置文件后运行bin目录下的odps(在Linux系统下是./bin/odps，Windows下运行./bin/odps.bat)，现在可以运行几个SQL。</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">sql</span>  <span class="c1">-- 进入sql shell。只有进入sql shell，才能运行sql 语句。</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">tbl1</span><span class="p">(</span><span class="n">id</span> <span class="nb">bigint</span><span class="p">);</span>
<span class="k">insert</span> <span class="n">overwrite</span> <span class="k">table</span> <span class="n">tbl1</span> <span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">tbl1</span><span class="p">;</span>
<span class="k">select</span> <span class="s1">&#39;welcome to odps!&#39;</span> <span class="k">from</span> <span class="n">tbl1</span><span class="p">;</span>
</pre></div>
</div>
<p>ODPS同样提供了上传下载数据的方式，下面我们将给出这样一个示例：</p>
<p>创建销售表sale_detail：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">create</span> <span class="k">table</span> <span class="n">if</span> <span class="k">not</span> <span class="k">exists</span> <span class="n">sale_detail</span><span class="p">(</span>
    <span class="n">shop_name</span>     <span class="n">string</span><span class="p">,</span>
    <span class="n">customer_id</span>   <span class="n">string</span><span class="p">,</span>
    <span class="n">total_price</span>   <span class="n">double</span><span class="p">)</span>
<span class="n">partitioned</span> <span class="k">by</span> <span class="p">(</span><span class="n">sale_date</span> <span class="n">string</span><span class="p">,</span><span class="n">region</span> <span class="n">string</span><span class="p">);</span>
</pre></div>
</div>
<p>此表是一张分区表，详细介绍请参阅 <a class="reference internal" href="odps_sql/odps_sql_grmr.html#odps-sql-create-table"><em>创建表(CREATE TABLE)</em></a> 。向表中添加杭州和上海两地区2013年10月和11月份的分区：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">alter</span> <span class="k">table</span> <span class="n">sale_detail</span> <span class="k">add</span> <span class="n">partition</span> <span class="p">(</span><span class="n">sale_date</span><span class="o">=</span><span class="s1">&#39;201310&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;hangzhou&#39;</span><span class="p">);</span>
<span class="k">alter</span> <span class="k">table</span> <span class="n">sale_detail</span> <span class="k">add</span> <span class="n">partition</span> <span class="p">(</span><span class="n">sale_date</span><span class="o">=</span><span class="s1">&#39;201311&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;hangzhou&#39;</span><span class="p">);</span>
<span class="k">alter</span> <span class="k">table</span> <span class="n">sale_detail</span> <span class="k">add</span> <span class="n">partition</span> <span class="p">(</span><span class="n">sale_date</span><span class="o">=</span><span class="s1">&#39;201310&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;shanghai&#39;</span><span class="p">);</span>
<span class="k">alter</span> <span class="k">table</span> <span class="n">sale_detail</span> <span class="k">add</span> <span class="n">partition</span> <span class="p">(</span><span class="n">sale_date</span><span class="o">=</span><span class="s1">&#39;201311&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;shanghai&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>添加分区的介绍请参阅 <a class="reference internal" href="odps_sql/odps_sql_grmr.html#odps-sql-add-partition"><em>添加分区(ADD PARTITIONS)</em></a> 。准备这4个分区的数据：杭州市2013年10月销售记录：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">shop1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span>
<span class="n">shop2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">200</span>
</pre></div>
</div>
<p>杭州市2013年11月销售记录：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">shop3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">300</span>
<span class="n">shop4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">400</span>
</pre></div>
</div>
<p>上海市2013年10月销售记录：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">shop5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">500</span>
<span class="n">shop6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">600</span>
</pre></div>
</div>
<p>上海市2013年11月销售记录：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">shop7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">700</span>
<span class="n">shop8</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">800</span>
</pre></div>
</div>
<p>将这4份数据保存到4分本地文件中：hangzhou_10.txt，hangzhou_11.txt，shanghai_10.txt，shanghai_11.txt。分别将其上传至ODPS的表中。ODPS为用户提供了数据上传及下载的工具。用户可以从阿里云官网上下载这个工具，解压此文件，会看到如下目录及文件：</p>
<div class="highlight-python"><pre>config.ini  dship  dship.bat  lib/</pre>
</div>
<p>其中，dship是Linux系统下的可执行文件，dship.bat是Windows下的可执行文件，lib是工具依赖的库文件路径，config.ini是配置文件。编辑config.ini，填写相关信息：</p>
<div class="highlight-python"><pre>tunnel-endpoint=&lt;Tunnel服务的地址，请注意公网服务与内网服务的区别&gt;
  #Tunnel服务内网地址：http://dt-ext.odps.aliyun-inc.com
  #Tunnel服务公网地址：http://dt.odps.aliyun.com
id=&lt;阿里云账号相关信息&gt;
key=&lt;阿里云账号相关信息&gt;
project=&lt;默认项目空间名称，配置此项后不必特殊指定数据导入、导出表所在的项目空间&gt;</pre>
</div>
<p>将数据文件导入ODPS：</p>
<div class="highlight-python"><pre>./dship upload hangzhou_10.txt sale_detail/sale_date='201310',region='hangzhou'
./dship upload hangzhou_11.txt sale_detail/sale_date='201311',region='hangzhou'
./dship upload shanghai_10.txt sale_detail/sale_date='201310',region='shanghai'
./dship upload shanghai_11.txt sale_detail/sale_date='201311',region='shanghai'</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">关于dship工具的详细说明请参考 <a class="reference internal" href="odps_tools/odps_dship.html#odps-dship"><em>ODPS数据上传下载工具</em></a> 。</p>
</div>
<p>验证数据：</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">sale_detail</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ODPS 基本概念及常用命令</a><ul>
<li><a class="reference internal" href="#id1">ODPS基本概念</a><ul>
<li><a class="reference internal" href="#project">项目空间(Project)</a></li>
<li><a class="reference internal" href="#table">表(Table)</a></li>
<li><a class="reference internal" href="#data-type">数据类型(Data Type)</a></li>
<li><a class="reference internal" href="#resource">资源(Resource)</a></li>
<li><a class="reference internal" href="#udf">自定义函数(UDF)</a></li>
<li><a class="reference internal" href="#task">任务(Task)</a></li>
<li><a class="reference internal" href="#instance">实例(Instance)</a></li>
<li><a class="reference internal" href="#security">安全(Security)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#odps-command">ODPS常用命令</a><ul>
<li><a class="reference internal" href="#use-project">Use Project</a></li>
<li><a class="reference internal" href="#create">Create操作</a><ul>
<li><a class="reference internal" href="#odps-common-add-resource-cmd">创建资源</a></li>
<li><a class="reference internal" href="#odps-common-create-func">创建函数</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delete">Delete操作</a><ul>
<li><a class="reference internal" href="#odps-common-del-resource-cmd">删除资源</a></li>
<li><a class="reference internal" href="#odps-common-del-func">删除函数</a></li>
</ul>
</li>
<li><a class="reference internal" href="#list">List操作</a><ul>
<li><a class="reference internal" href="#id7">查看表清单</a></li>
<li><a class="reference internal" href="#odps-common-list-resource-cmd">查看资源清单</a></li>
<li><a class="reference internal" href="#odps-common-ls-func">查看函数清单</a></li>
<li><a class="reference internal" href="#id10">查看实例清单</a></li>
</ul>
</li>
<li><a class="reference internal" href="#describe">Describe操作</a><ul>
<li><a class="reference internal" href="#id11">查看项目空间信息</a></li>
<li><a class="reference internal" href="#odps-common-desc-table-cmd">查看表信息</a></li>
<li><a class="reference internal" href="#odps-common-desc-partition-cmd">查看表分区信息</a></li>
<li><a class="reference internal" href="#odps-common-desc-resource-cmd">查看资源信息</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id15">其他实例相关操作</a><ul>
<li><a class="reference internal" href="#status-instance">Status Instance</a></li>
<li><a class="reference internal" href="#kill-instance">Kill Instance</a></li>
<li><a class="reference internal" href="#attach-instance">Attach Instance</a></li>
</ul>
</li>
<li><a class="reference internal" href="#log">Log</a></li>
</ul>
</li>
<li><a class="reference internal" href="#odps-pre-case-tunnel">快速开始</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="odps_sql/index.html" title="ODPS SQL"
             >next</a></li>
        <li class="right" >
          <a href="../index.html" title="ODPS产品文档中心"
             >previous</a> |</li>
        <li><a href="../index.html">ODPS 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Alibaba 2014-07-01.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b1.
    </div>
  <!-- 请把脚本放到 body 元素内 -->
  </body>
</html>