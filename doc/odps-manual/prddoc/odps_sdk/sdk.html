<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ODPS SDK介绍 &mdash; ODPS 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="ODPS 1.0 documentation" href="../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../java_sand_box/odps_sandbox.html" title="Java沙箱"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../odps_tunnel/odps_tunnel_examples.html" title="Tunnel SDK 示例"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">ODPS 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="odps-sdk">
<span id="id1"></span><h1>ODPS SDK介绍<a class="headerlink" href="#odps-sdk" title="Permalink to this headline">¶</a></h1>
<p>在本小节，我们仅会对较为常用的ODPS核心接口做简短介绍，更多详细信息请参阅SDK Java Doc。</p>
<div class="section" id="aliyunaccount">
<span id="odps-sdk-aliyunaccount"></span><h2>AliyunAccount<a class="headerlink" href="#aliyunaccount" title="Permalink to this headline">¶</a></h2>
<p>阿里云认证账号。输入参数为accessId及accessKey，是阿里云用户的身份标识和认证密钥。此类用来初始化 <a class="reference internal" href="#odps-sdk-odps"><em>Odps</em></a> 。</p>
</div>
<div class="section" id="odps">
<span id="odps-sdk-odps"></span><h2>Odps<a class="headerlink" href="#odps" title="Permalink to this headline">¶</a></h2>
<p>ODPS SDK的入口，用户通过此类来获取项目空间下的所有对象集合，包括: <a class="reference internal" href="#odps-sdk-projects"><em>Projects</em></a> ，<a class="reference internal" href="#odps-sdk-tables"><em>Tables</em></a> ，<a class="reference internal" href="#odps-sdk-resources"><em>Resources</em></a> ，<a class="reference internal" href="#odps-sdk-functions"><em>Functions</em></a> ，<a class="reference internal" href="#odps-sdk-instances"><em>Instances</em></a> 。用户可以通过传入 <a class="reference internal" href="#odps-sdk-aliyunaccount"><em>AliyunAccount</em></a> 实例来构造ODPS对象。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="s">&quot;my_project&quot;</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Table</span> <span class="n">t</span> <span class="o">:</span> <span class="n">odps</span><span class="o">.</span><span class="na">tables</span><span class="o">())</span> <span class="o">{</span>
    <span class="o">....</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="projects">
<span id="odps-sdk-projects"></span><h2>Projects<a class="headerlink" href="#projects" title="Permalink to this headline">¶</a></h2>
<p>ODPS中所有项目空间的集合。集合中的元素为 <a class="reference internal" href="#odps-sdk-project"><em>Project</em></a> 。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">Project</span> <span class="n">p</span> <span class="o">=</span> <span class="n">odps</span><span class="o">.</span><span class="na">projects</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;my_exists&quot;</span><span class="o">);</span>
</pre></div>
</div>
</div>
<div class="section" id="project">
<span id="odps-sdk-project"></span><h2>Project<a class="headerlink" href="#project" title="Permalink to this headline">¶</a></h2>
<p>对项目空间信息的描述，可以通过 <a class="reference internal" href="#odps-sdk-projects"><em>Projects</em></a> 获取相应的项目空间。</p>
</div>
<div class="section" id="sqltask">
<span id="odps-sdk-sqltask"></span><h2>SQLTask<a class="headerlink" href="#sqltask" title="Permalink to this headline">¶</a></h2>
<p>用于运行、处理SQL任务的接口。可以通过run接口直接运行SQL。run接口返回 <a class="reference internal" href="#odps-sdk-instance"><em>Instance</em></a> 实例，通过Instance获取SQL的运行状态及运行结果。程序示例如下，仅供参考：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>
<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>

<span class="n">Instance</span> <span class="n">instance</span> <span class="o">=</span> <span class="n">SQLTask</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">odps</span><span class="o">,</span> <span class="s">&quot;my_project&quot;</span><span class="o">,</span> <span class="s">&quot;select ...&quot;</span><span class="o">);</span>
<span class="n">id</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span>

<span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">taskNames</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="na">getTaskNames</span><span class="o">();</span>
<span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">taskNames</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">TaskSummary</span> <span class="n">summary</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="na">getTaskSummary</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="n">String</span> <span class="n">s</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="na">getSummaryText</span><span class="o">();</span>
<span class="o">}</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">results</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="na">getTaskResults</span><span class="o">();</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">TaskStatus</span><span class="o">&gt;</span> <span class="n">taskStatus</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="na">getTaskStatus</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">TaskStatus</span><span class="o">&gt;</span> <span class="n">status</span> <span class="o">:</span> <span class="n">taskStatus</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">status</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">如果用户想创建表，需要通过SQLTask接口，而不是 <a class="reference internal" href="#odps-sdk-table"><em>Table</em></a> 接口。用户需要将 <a class="reference internal" href="../odps_sql/odps_sql_grmr.html#odps-sql-create-table"><em>创建表(CREATE TABLE)</em></a> 的语句传入SQLTask。</p>
</div>
</div>
<div class="section" id="instances">
<span id="odps-sdk-instances"></span><h2>Instances<a class="headerlink" href="#instances" title="Permalink to this headline">¶</a></h2>
<p>ODPS中所有实例(Instance)的集合。集合中的元素为 <a class="reference internal" href="#odps-sdk-instance"><em>Instance</em></a> 。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="s">&quot;my_project&quot;</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Instance</span> <span class="n">i</span> <span class="o">:</span> <span class="n">odps</span><span class="o">.</span><span class="na">instances</span><span class="o">())</span> <span class="o">{</span>
    <span class="o">....</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="instance">
<span id="odps-sdk-instance"></span><h2>Instance<a class="headerlink" href="#instance" title="Permalink to this headline">¶</a></h2>
<p>对实例信息的描述，可以通过 <a class="reference internal" href="#odps-sdk-instances"><em>Instances</em></a> 获取相应的实例。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">Instance</span> <span class="n">ins</span> <span class="o">=</span> <span class="n">odps</span><span class="o">.</span><span class="na">instances</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;instance id&quot;</span><span class="o">);</span>
</pre></div>
</div>
</div>
<div class="section" id="tables">
<span id="odps-sdk-tables"></span><h2>Tables<a class="headerlink" href="#tables" title="Permalink to this headline">¶</a></h2>
<p>ODPS中所有表的集合。集合中的元素为 <a class="reference internal" href="#odps-sdk-table"><em>Table</em></a> 。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="s">&quot;my_project&quot;</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Table</span> <span class="n">t</span> <span class="o">:</span> <span class="n">odps</span><span class="o">.</span><span class="na">tables</span><span class="o">())</span> <span class="o">{</span>
    <span class="o">....</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="table">
<span id="odps-sdk-table"></span><h2>Table<a class="headerlink" href="#table" title="Permalink to this headline">¶</a></h2>
<p>对表信息的描述，可以通过 <a class="reference internal" href="#odps-sdk-tables"><em>Tables</em></a> 获取相应的表。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">t</span> <span class="o">=</span> <span class="n">odps</span><span class="o">.</span><span class="na">tables</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;table name&quot;</span><span class="o">);</span>
</pre></div>
</div>
</div>
<div class="section" id="resources">
<span id="odps-sdk-resources"></span><h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<p>ODPS中所有资源的集合。集合中的元素为 <a class="reference internal" href="#odps-sdk-resource"><em>Resource</em></a> 。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="s">&quot;my_project&quot;</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Resource</span> <span class="n">r</span> <span class="o">:</span> <span class="n">odps</span><span class="o">.</span><span class="na">resources</span><span class="o">())</span> <span class="o">{</span>
    <span class="o">....</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="resource">
<span id="odps-sdk-resource"></span><h2>Resource<a class="headerlink" href="#resource" title="Permalink to this headline">¶</a></h2>
<p>对资源信息的描述，可以通过 <a class="reference internal" href="#odps-sdk-resources"><em>Resources</em></a> 获取相应的资源。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">Resource</span> <span class="n">r</span> <span class="o">=</span> <span class="n">odps</span><span class="o">.</span><span class="na">resources</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;resource name&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>一个创建文件资源的示例：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">String</span> <span class="n">projectName</span> <span class="o">=</span> <span class="s">&quot;my_porject&quot;</span><span class="o">;</span>

<span class="n">String</span> <span class="n">source</span> <span class="o">=</span> <span class="s">&quot;my_local_file.txt&quot;</span><span class="o">;</span>
<span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
<span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>

<span class="n">FileResource</span> <span class="n">resource</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileResource</span><span class="o">();</span>
<span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
<span class="n">resource</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>

<span class="n">odps</span><span class="o">.</span><span class="na">resources</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">projectName</span><span class="o">,</span> <span class="n">resource</span><span class="o">,</span> <span class="n">is</span><span class="o">);</span>
</pre></div>
</div>
<p>一个创建表资源的示例：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">TableResource</span> <span class="n">resource</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TableResource</span><span class="o">(</span><span class="n">tableName</span><span class="o">,</span> <span class="n">tablePrj</span><span class="o">,</span> <span class="n">partitionSpec</span><span class="o">);</span>
<span class="c1">//resource.setName(INVALID_USER_TABLE);</span>
<span class="n">resource</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;table_resource_name&quot;</span><span class="o">);</span>
<span class="n">odps</span><span class="o">.</span><span class="na">resources</span><span class="o">().</span><span class="na">update</span><span class="o">(</span><span class="n">projectName</span><span class="o">,</span> <span class="n">resource</span><span class="o">);</span>
</pre></div>
</div>
</div>
<div class="section" id="functions">
<span id="odps-sdk-functions"></span><h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>ODPS中所有函数的集合。集合中的元素为 <a class="reference internal" href="#odps-sdk-function"><em>Function</em></a> 。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setDefaultProject</span><span class="o">(</span><span class="s">&quot;my_project&quot;</span><span class="o">);</span>

<span class="k">for</span> <span class="o">(</span><span class="n">Function</span> <span class="n">f</span> <span class="o">:</span> <span class="n">odps</span><span class="o">.</span><span class="na">functions</span><span class="o">())</span> <span class="o">{</span>
    <span class="o">....</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="function">
<span id="odps-sdk-function"></span><h2>Function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h2>
<p>对函数信息的描述，可以通过 <a class="reference internal" href="#odps-sdk-functions"><em>Functions</em></a> 获取相应的函数。程序示例如下：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">Account</span> <span class="n">account</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AliyunAccount</span><span class="o">(</span><span class="s">&quot;my_access_id&quot;</span><span class="o">,</span> <span class="s">&quot;my_access_key&quot;</span><span class="o">);</span>

<span class="n">Odps</span> <span class="n">odps</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Odps</span><span class="o">(</span><span class="n">account</span><span class="o">);</span>
<span class="cm">/*</span>
<span class="cm"> * odps服务内网地址：http://odps-ext.aliyun-inc.com/api</span>
<span class="cm"> * odps服务公网地址：http://service.odps.aliyun.com/api</span>
<span class="cm"> * 仅当用户处于阿里云内网环境时，才能使用odps服务内网地址</span>
<span class="cm">*/</span>
<span class="n">String</span> <span class="n">odpsUrl</span> <span class="o">=</span> <span class="s">&quot;&lt;your odps endpoint&gt;&quot;</span><span class="o">;</span>
<span class="n">odps</span><span class="o">.</span><span class="na">setEndpoint</span><span class="o">(</span><span class="n">odpsUrl</span><span class="o">);</span>

<span class="n">Function</span> <span class="n">f</span> <span class="o">=</span> <span class="n">odps</span><span class="o">.</span><span class="na">functions</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;function name&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>一个创建函数的示例：</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">String</span> <span class="n">resources</span> <span class="o">=</span> <span class="s">&quot;xxx:xxx&quot;</span><span class="o">;</span>
<span class="n">String</span> <span class="n">classType</span> <span class="o">=</span> <span class="s">&quot;com.aliyun.odps.mapred.open.example.WordCount&quot;</span><span class="o">;</span>

<span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">resourceList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">r</span> <span class="o">:</span> <span class="n">resources</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot;:&quot;</span><span class="o">))</span> <span class="o">{</span>
  <span class="n">resourceList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">Function</span> <span class="n">func</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Function</span><span class="o">();</span>
<span class="n">func</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
<span class="n">func</span><span class="o">.</span><span class="na">setClassType</span><span class="o">(</span><span class="n">classType</span><span class="o">);</span>
<span class="n">func</span><span class="o">.</span><span class="na">setResources</span><span class="o">(</span><span class="n">resourceList</span><span class="o">);</span>

<span class="n">odps</span><span class="o">.</span><span class="na">functions</span><span class="o">().</span><span class="na">create</span><span class="o">(</span><span class="n">projectName</span><span class="o">,</span> <span class="n">func</span><span class="o">);</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ODPS SDK介绍</a><ul>
<li><a class="reference internal" href="#aliyunaccount">AliyunAccount</a></li>
<li><a class="reference internal" href="#odps">Odps</a></li>
<li><a class="reference internal" href="#projects">Projects</a></li>
<li><a class="reference internal" href="#project">Project</a></li>
<li><a class="reference internal" href="#sqltask">SQLTask</a></li>
<li><a class="reference internal" href="#instances">Instances</a></li>
<li><a class="reference internal" href="#instance">Instance</a></li>
<li><a class="reference internal" href="#tables">Tables</a></li>
<li><a class="reference internal" href="#table">Table</a></li>
<li><a class="reference internal" href="#resources">Resources</a></li>
<li><a class="reference internal" href="#resource">Resource</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#function">Function</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../java_sand_box/odps_sandbox.html" title="Java沙箱"
             >next</a></li>
        <li class="right" >
          <a href="../odps_tunnel/odps_tunnel_examples.html" title="Tunnel SDK 示例"
             >previous</a> |</li>
        <li><a href="../../index.html">ODPS 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright Alibaba 2014-07-01.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2b1.
    </div>
  <!-- 请把脚本放到 body 元素内 -->
  </body>
</html>